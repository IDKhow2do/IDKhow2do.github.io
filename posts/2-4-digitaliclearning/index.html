<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>2-4 Digital IC Learning - 一夔的小窝</title><meta name="Description" content=""><meta property="og:title" content="2-4 Digital IC Learning" />
<meta property="og:description" content="参考书籍 Digital VLSI Design and Simulation with Verilog 组合逻辑电路 与门 或门 非门 通用门 可以构建任何逻辑的门 NAND NOR 组合逻辑电路 输出只和输入有关，没有可用的记忆元件的电路，并且可能" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://maequeen.top/posts/2-4-digitaliclearning/" /><meta property="og:image" content="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202305010204833.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-03T01:49:23+08:00" />
<meta property="article:modified_time" content="2024-04-03T01:49:23+08:00" /><meta property="og:site_name" content="我的个人网站" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202305010204833.png" /><meta name="twitter:title" content="2-4 Digital IC Learning"/>
<meta name="twitter:description" content="参考书籍 Digital VLSI Design and Simulation with Verilog 组合逻辑电路 与门 或门 非门 通用门 可以构建任何逻辑的门 NAND NOR 组合逻辑电路 输出只和输入有关，没有可用的记忆元件的电路，并且可能"/>
      <meta name="twitter:site" content="@这不是我"/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://maequeen.top/posts/2-4-digitaliclearning/" /><link rel="prev" href="http://maequeen.top/posts/2-2-say-thank-you-to-ehco-the-free-gpt4/" /><link rel="next" href="http://maequeen.top/posts/2-5-qingming-in-wudangs-not-a-good-idea/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "2-4 Digital IC Learning",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/maequeen.top\/posts\/2-4-digitaliclearning\/"
        },"genre": "posts","wordcount":  17305 ,
        "url": "http:\/\/maequeen.top\/posts\/2-4-digitaliclearning\/","datePublished": "2024-04-03T01:49:23+08:00","dateModified": "2024-04-03T01:49:23+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "龙山"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="一夔的小窝"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png"
        data-srcset="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png, https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png 1.5x, https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png 2x"
        data-sizes="auto"
        alt="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png"
        title="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png" /><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="想写什么就写什么的文章"> 文章 </a><a class="menu-item" href="/tags/" title="不知道我会不会记得区分标签"> 标签 </a><a class="menu-item" href="/categories/" title="分类和标签，傻傻分不清楚"> 分类 </a><a class="menu-item" href="/photowall/" title="3D照片墙"> 照片墙 </a><a class="menu-item" href="/about/"> 关于 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="一夔的小窝"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png"
        data-srcset="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png, https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png 1.5x, https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png 2x"
        data-sizes="auto"
        alt="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png"
        title="https://mayue-1312060474.cos.ap-chengdu.myqcloud.com/picgo/202307191619851.png" /><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="想写什么就写什么的文章">文章</a><a class="menu-item" href="/tags/" title="不知道我会不会记得区分标签">标签</a><a class="menu-item" href="/categories/" title="分类和标签，傻傻分不清楚">分类</a><a class="menu-item" href="/photowall/" title="3D照片墙">照片墙</a><a class="menu-item" href="/about/" title="">关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">2-4 Digital IC Learning</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>龙山</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-04-03">2024-04-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;17305 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;35 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#组合逻辑电路">组合逻辑电路</a>
      <ul>
        <li><a href="#通用门">通用门</a></li>
        <li><a href="#组合逻辑电路-1">组合逻辑电路</a></li>
      </ul>
    </li>
    <li><a href="#时序逻辑电路">时序逻辑电路</a>
      <ul>
        <li><a href="#触发器">触发器</a></li>
        <li><a href="#寄存器">寄存器</a></li>
        <li><a href="#计数器">计数器</a></li>
        <li><a href="#有限状态机">有限状态机</a></li>
      </ul>
    </li>
    <li><a href="#导论到verilog-hdl">导论到Verilog HDL</a>
      <ul>
        <li><a href="#verilog-hdl的基础知识">verilog HDL的基础知识</a></li>
        <li><a href="#抽象级别和建模的概念">抽象级别和建模的概念</a></li>
        <li><a href="#基础语法规定">基础语法规定</a></li>
        <li><a href="#数据类型">数据类型</a></li>
        <li><a href="#testbench-概念">testbench 概念</a></li>
      </ul>
    </li>
    <li><a href="#verilog中的编程技术">Verilog中的编程技术</a>
      <ul>
        <li></li>
        <li><a href="#组合逻辑电路-2">组合逻辑电路</a></li>
      </ul>
    </li>
    <li><a href="#verilog-中的编程技术2">Verilog 中的编程技术2</a>
      <ul>
        <li><a href="#verilog中的编程技术2">verilog中的编程技术2</a></li>
        <li><a href="#电路的数据流模型">电路的数据流模型</a></li>
        <li><a href="#组合电路的数据流类型">组合电路的数据流类型</a></li>
        <li><a href="#多路复用器">多路复用器</a></li>
      </ul>
    </li>
    <li><a href="#verilog中的编程技术3">verilog中的编程技术3</a>
      <ul>
        <li><a href="#组合电路的行为模型">组合电路的行为模型</a></li>
        <li><a href="#时序电路的行为模型">时序电路的行为模型</a></li>
        <li><a href="#d触发器的行为建模">D触发器的行为建模</a></li>
        <li><a href="#jk触发器的行为建模">JK触发器的行为建模</a></li>
        <li><a href="#使用jk触发器来完成d触发器的行为建模">使用JK触发器来完成D触发器的行为建模</a></li>
        <li><a href="#使用jk触发器来完成t触发器的行为建模">使用JK触发器来完成T触发器的行为建模</a></li>
        <li><a href="#使用jk触发器对sr触发器建模">使用JK触发器对SR触发器建模</a></li>
      </ul>
    </li>
    <li><a href="#使用开关进行数字设计">使用开关进行数字设计</a>
      <ul>
        <li><a href="#开关门建模">开关门建模</a></li>
        <li><a href="#使用cmos技术的数字设计">使用CMOS技术的数字设计</a></li>
      </ul>
    </li>
    <li><a href="#cmos-反相器">CMOS 反相器</a>
      <ul>
        <li><a href="#使用开关设计和实现组合逻辑电路">使用开关设计和实现组合逻辑电路</a></li>
        <li><a href="#使用开关来完成逻辑实现">使用开关来完成逻辑实现</a></li>
        <li><a href="#使用双向开关来实现">使用双向开关来实现</a></li>
        <li><a href="#采用结构级建模的verilog开关级描述">采用结构级建模的verilog开关级描述</a></li>
        <li><a href="#带延迟的开关模型">带延迟的开关模型</a></li>
      </ul>
    </li>
    <li><a href="#高级verilog主题">高级verilog主题</a>
      <ul>
        <li><a href="#延迟建模和编程">延迟建模和编程</a></li>
        <li><a href="#用户自定义的原语udp">用户自定义的原语UDP</a></li>
        <li><a href="#任务和函数">任务和函数</a></li>
      </ul>
    </li>
    <li><a href="#可编程和可配置器件">可编程和可配置器件</a>
      <ul>
        <li><a href="#逻辑综合">逻辑综合</a></li>
        <li><a href="#可编程逻辑器件的介绍">可编程逻辑器件的介绍</a></li>
        <li><a href="#可编程门阵列fpga">可编程门阵列FPGA</a></li>
        <li><a href="#香农的扩展和查找表">香农的扩展和查找表</a></li>
        <li><a href="#fpga家族">FPGA家族</a></li>
        <li><a href="#使用fpga进行编程">使用FPGA进行编程</a></li>
        <li><a href="#asic及其应用">ASIC及其应用</a></li>
      </ul>
    </li>
    <li><a href="#基于verilog-hdl的项目">基于Verilog HDL的项目</a>
      <ul>
        <li><a href="#基于verilog-hdl的组合逻辑项目">基于Verilog HDL的组合逻辑项目</a></li>
        <li><a href="#基于verilog-hdl设计时序电路">基于verilog HDL设计时序电路</a></li>
        <li><a href="#计数器设计">计数器设计</a></li>
      </ul>
    </li>
    <li><a href="#system-verilog">System Verilog</a>
      <ul>
        <li><a href="#介绍">介绍</a></li>
        <li><a href="#sv的独特特性">SV的独特特性</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>参考书籍
Digital VLSI Design and Simulation with Verilog</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://m.media-amazon.com/images/I/71VPw5c3Q-L._SL1360_.jpg"
        data-srcset="https://m.media-amazon.com/images/I/71VPw5c3Q-L._SL1360_.jpg, https://m.media-amazon.com/images/I/71VPw5c3Q-L._SL1360_.jpg 1.5x, https://m.media-amazon.com/images/I/71VPw5c3Q-L._SL1360_.jpg 2x"
        data-sizes="auto"
        alt="https://m.media-amazon.com/images/I/71VPw5c3Q-L._SL1360_.jpg"
        title="https://m.media-amazon.com/images/I/71VPw5c3Q-L._SL1360_.jpg" /></p>
<h2 id="组合逻辑电路">组合逻辑电路</h2>
<ul>
<li>与门</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/adf293f8ae710cf01cb93.png"
        data-srcset="https://tg-image.com/file/adf293f8ae710cf01cb93.png, https://tg-image.com/file/adf293f8ae710cf01cb93.png 1.5x, https://tg-image.com/file/adf293f8ae710cf01cb93.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/adf293f8ae710cf01cb93.png"
        title="truth table|543" /></p>
<ul>
<li>或门</li>
<li>非门</li>
</ul>
<h3 id="通用门">通用门</h3>
<p>可以构建任何逻辑的门</p>
<ul>
<li>NAND</li>
<li>NOR</li>
</ul>
<h3 id="组合逻辑电路-1">组合逻辑电路</h3>
<p>输出只和输入有关，没有可用的记忆元件的电路，并且可能包含多个子系统。</p>
<h4 id="组合逻辑介绍">组合逻辑介绍</h4>
<ul>
<li>半加法器
<ul>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/a49b93c1edc50f44d17f7.png"
        data-srcset="https://tg-image.com/file/a49b93c1edc50f44d17f7.png, https://tg-image.com/file/a49b93c1edc50f44d17f7.png 1.5x, https://tg-image.com/file/a49b93c1edc50f44d17f7.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/a49b93c1edc50f44d17f7.png"
        title="加法器真值表" /></li>
<li>逻辑表达式：半加器（不包含进位信号）</li>
<li>$$\begin{align*}
\text{Sum} &amp;= \overline{A}B + A\overline{B} \
&amp;= A \oplus B \
\text{Carry} &amp;= AB
\end{align*}
$$
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/2556609120423ce5d1fe2.png"
        data-srcset="https://tg-image.com/file/2556609120423ce5d1fe2.png, https://tg-image.com/file/2556609120423ce5d1fe2.png 1.5x, https://tg-image.com/file/2556609120423ce5d1fe2.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/2556609120423ce5d1fe2.png"
        title="电路图" /></li>
<li>全加法器：这里就是有三个输入了，因为多了一个cin的进位输入信号。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/f494d893dffd61531256b.png"
        data-srcset="https://tg-image.com/file/f494d893dffd61531256b.png, https://tg-image.com/file/f494d893dffd61531256b.png 1.5x, https://tg-image.com/file/f494d893dffd61531256b.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/f494d893dffd61531256b.png"
        title="真值表" /></li>
<li>逻辑表达式：$$\begin{align*}
\text{Sum} &amp;= A \oplus B \oplus \text{Cin} \
\text{Cout} &amp;= AB + BCin + CinA
\end{align*}
$$
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/86be444d674355f99f7b1.png"
        data-srcset="https://tg-image.com/file/86be444d674355f99f7b1.png, https://tg-image.com/file/86be444d674355f99f7b1.png 1.5x, https://tg-image.com/file/86be444d674355f99f7b1.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/86be444d674355f99f7b1.png"
        title="电路图|300" /></li>
<li>半减法器</li>
<li>全减法器</li>
</ul>
</li>
<li>mux多路复用器，根据选择信号，将指定的输入信号给到输出，只有一个输出信号，如果有2的n次方的信号，则需要n个选择信号。
<ul>
<li>电路图
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/cbc9988ac5383c447ea18.png"
        data-srcset="https://tg-image.com/file/cbc9988ac5383c447ea18.png, https://tg-image.com/file/cbc9988ac5383c447ea18.png 1.5x, https://tg-image.com/file/cbc9988ac5383c447ea18.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/cbc9988ac5383c447ea18.png"
        title="https://tg-image.com/file/cbc9988ac5383c447ea18.png" /></li>
<li>可以用来实现具体的逻辑（也是FPGA的LUT的原理来源）</li>
<li>De-mux，将选择信号选中的输入信号到指定的输出信号输出。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/e70b62ac0e89bcb167f19.png"
        data-srcset="https://tg-image.com/file/e70b62ac0e89bcb167f19.png, https://tg-image.com/file/e70b62ac0e89bcb167f19.png 1.5x, https://tg-image.com/file/e70b62ac0e89bcb167f19.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/e70b62ac0e89bcb167f19.png"
        title="https://tg-image.com/file/e70b62ac0e89bcb167f19.png" /></li>
<li>decoder译码器：将输入的信号译码为独热的输出信号。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/23bf375512a3dd92f7b17.png"
        data-srcset="https://tg-image.com/file/23bf375512a3dd92f7b17.png, https://tg-image.com/file/23bf375512a3dd92f7b17.png 1.5x, https://tg-image.com/file/23bf375512a3dd92f7b17.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/23bf375512a3dd92f7b17.png"
        title="https://tg-image.com/file/23bf375512a3dd92f7b17.png" /></li>
</ul>
</li>
<li>乘法器multiplier:</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/2b91f28f31609460c2150.png"
        data-srcset="https://tg-image.com/file/2b91f28f31609460c2150.png, https://tg-image.com/file/2b91f28f31609460c2150.png 1.5x, https://tg-image.com/file/2b91f28f31609460c2150.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/2b91f28f31609460c2150.png"
        title="https://tg-image.com/file/2b91f28f31609460c2150.png" />
<ul>
<li>流程图：这是一个两位乘法器的结果，用到两个半加器。如图所示流程。</li>
</ul>
</li>
<li>比较器
<ul>
<li>一般是通过写出真值表来完成设计的，两位比较器的真值表和逻辑表达式如下
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/29b6463456749a81abe83.png"
        data-srcset="https://tg-image.com/file/29b6463456749a81abe83.png, https://tg-image.com/file/29b6463456749a81abe83.png 1.5x, https://tg-image.com/file/29b6463456749a81abe83.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/29b6463456749a81abe83.png"
        title="https://tg-image.com/file/29b6463456749a81abe83.png" /></li>
</ul>
</li>
<li>Code Converters 编码转换器
<ul>
<li>真值表设计</li>
<li>十进制2BCD</li>
</ul>
</li>
</ul>
<h2 id="时序逻辑电路">时序逻辑电路</h2>
<h3 id="触发器">触发器</h3>
<p>触发器是一种可以存储二进制比特位数据的器件，有两种状态，一种是预置，一种是清零。有两个互补的输出，</p>
<ul>
<li>3个控制信号
<ul>
<li>时钟：用于同步电路一般</li>
<li>set</li>
<li>reset</li>
</ul>
</li>
</ul>
<h4 id="sr触发器">SR触发器</h4>
<p>是基本的电路，其他的触发器可以用SR触发器来实现。SR != 1，否则会出现不定状态。时钟边沿触发，此处为上升沿。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/93b48bc6f2c73d3f4db05.png"
        data-srcset="https://tg-image.com/file/93b48bc6f2c73d3f4db05.png, https://tg-image.com/file/93b48bc6f2c73d3f4db05.png 1.5x, https://tg-image.com/file/93b48bc6f2c73d3f4db05.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/93b48bc6f2c73d3f4db05.png"
        title="https://tg-image.com/file/93b48bc6f2c73d3f4db05.png" /></p>
<ul>
<li>D触发器：其实就是把SR触发器的输入信号连在一起加了一个反相器。输出的下一个状态就是输入，也叫做延迟时钟输出器。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/6645965d308034a39a9a6.png"
        data-srcset="https://tg-image.com/file/6645965d308034a39a9a6.png, https://tg-image.com/file/6645965d308034a39a9a6.png 1.5x, https://tg-image.com/file/6645965d308034a39a9a6.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/6645965d308034a39a9a6.png"
        title="https://tg-image.com/file/6645965d308034a39a9a6.png" /></li>
<li>JK触发器：不存在JK != 1的限制，在这个条件下，输出反转。但是因为输出频繁切换容易导致竞争，因此应该尽量保持时钟周期低于JK触发器的输出延迟。（还有主从JK触发器的电路上的实现）</li>
<li><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/4350ba0d79e16a2f45dd7.png"
        data-srcset="https://tg-image.com/file/4350ba0d79e16a2f45dd7.png, https://tg-image.com/file/4350ba0d79e16a2f45dd7.png 1.5x, https://tg-image.com/file/4350ba0d79e16a2f45dd7.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/4350ba0d79e16a2f45dd7.png"
        title="https://tg-image.com/file/4350ba0d79e16a2f45dd7.png" /></li>
<li>T触发器：输入为1是反转信号，否则保持。</li>
</ul>
<h3 id="寄存器">寄存器</h3>
<p>一组触发器被称之为寄存器，可以用来存储数据，也可以拿来做计数器。时钟是寄存器常用的控制信号。</p>
<h4 id="串行输入和串行输出">串行输入和串行输出</h4>
<p>寄存器串联的方式存入数据和取出</p>
<h4 id="串行输入和并行输出">串行输入和并行输出</h4>
<p>串联的方式输入信号，当最后一位信号输入完毕的时候，每一个组成寄存器的触发器将数据输出，构成并行输出。</p>
<h4 id="并行输入和并行输出">并行输入和并行输出</h4>
<p>数据并行输入又输出，花费一个时钟周期的时间，因此又被称之为，缓冲器。</p>
<h4 id="并行输入和串行输出">并行输入和串行输出</h4>
<p>这里的电路图给出了外围的驱动，并行输入可以大幅提升工作效率，但是设计的复杂程度也会提高，其中两个块，一个是加载数据，一个是移位控制信号，通过一个2选1的mux来进行加载/移位的模式控制
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/ce56f858d72b63b04f2b1.png"
        data-srcset="https://tg-image.com/file/ce56f858d72b63b04f2b1.png, https://tg-image.com/file/ce56f858d72b63b04f2b1.png 1.5x, https://tg-image.com/file/ce56f858d72b63b04f2b1.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/ce56f858d72b63b04f2b1.png"
        title="https://tg-image.com/file/ce56f858d72b63b04f2b1.png" /></p>
<h3 id="计数器">计数器</h3>
<h4 id="同步计数器">同步计数器</h4>
<p>同步计数器的时钟被同时应用在了所有的触发器上，一般T和JK触发器经常被用来设计同步计数器，当它们被断言为1时，会反转状态为之前的状态，
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/e145721dc91c9ba04e67a.png"
        data-srcset="https://tg-image.com/file/e145721dc91c9ba04e67a.png, https://tg-image.com/file/e145721dc91c9ba04e67a.png 1.5x, https://tg-image.com/file/e145721dc91c9ba04e67a.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/e145721dc91c9ba04e67a.png"
        title="https://tg-image.com/file/e145721dc91c9ba04e67a.png" /></p>
<p>一个简单的3位JK同步计数器</p>
<p>D0是2分频，D1是4分频，D2是8分频，按照递增的顺序计数脉冲，</p>
<h4 id="异步计数器">异步计数器</h4>
<p>异步计数器的时钟输入来自前一个触发器的输出</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/79ebbd03cd1c689d23fc5.png"
        data-srcset="https://tg-image.com/file/79ebbd03cd1c689d23fc5.png, https://tg-image.com/file/79ebbd03cd1c689d23fc5.png 1.5x, https://tg-image.com/file/79ebbd03cd1c689d23fc5.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/79ebbd03cd1c689d23fc5.png"
        title="https://tg-image.com/file/79ebbd03cd1c689d23fc5.png" /></p>
<h4 id="环形计数器">环形计数器</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/926340d6f5715065eaf1a.png"
        data-srcset="https://tg-image.com/file/926340d6f5715065eaf1a.png, https://tg-image.com/file/926340d6f5715065eaf1a.png 1.5x, https://tg-image.com/file/926340d6f5715065eaf1a.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/926340d6f5715065eaf1a.png"
        title="https://tg-image.com/file/926340d6f5715065eaf1a.png" /></p>
<p>环形计数器将D触发器的首尾相连，在这里，计数器必须以任何非零值开始。假设给定的初始值是 0001，则序列将是 1000、0100、0010、0001，并且将再次重复相同的序列。</p>
<h4 id="约翰逊计数器">约翰逊计数器</h4>
<p>一般用于检测特定序列</p>
<h3 id="有限状态机">有限状态机</h3>
<p>是一种数学模型，任意时间提取一个状态数，包括状态图，状态表，激励表和电路图。</p>
<h4 id="mealy型和moore型">mealy型和moore型</h4>
<p>Mealy有限状态机的输出取决于外部的输入和反馈。用于检测的序列位数和状态位数相等。通常要比同样逻辑的Moore有限状态机状态数目少一个。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/199747b1bb9525b57d816.png"
        data-srcset="https://tg-image.com/file/199747b1bb9525b57d816.png, https://tg-image.com/file/199747b1bb9525b57d816.png 1.5x, https://tg-image.com/file/199747b1bb9525b57d816.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/199747b1bb9525b57d816.png"
        title="https://tg-image.com/file/199747b1bb9525b57d816.png" /></p>
<p>这是一个典型的Mealy状态机的结构图，</p>
<ul>
<li>下一状态的组合逻辑
<ul>
<li>基于当前的状态和外部的输入计算出下一个状态</li>
</ul>
</li>
<li>状态寄存器
<ul>
<li>存储元件用于保持当前的状态信息</li>
<li>在市中心好的控制下更新值，输出给输出组合逻辑来确定输出，同时也反馈给下一状态的组合逻辑来计算下一状态</li>
</ul>
</li>
<li>输出的组合逻辑
<ul>
<li>基于当前的状态和外部输入来产生输出信号</li>
<li>输出可能在输入改变时立即改变，不需要等待到下一个时钟周期（与Moore状态机仅依赖于当前状态不同）</li>
</ul>
</li>
</ul>
<p>Moore有限状态机与meely型不同的地方就是，Moore型的输出不受输入信号影响，只和当前状态有关</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/dd2d9491740e4fec83329.png"
        data-srcset="https://tg-image.com/file/dd2d9491740e4fec83329.png, https://tg-image.com/file/dd2d9491740e4fec83329.png 1.5x, https://tg-image.com/file/dd2d9491740e4fec83329.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/dd2d9491740e4fec83329.png"
        title="https://tg-image.com/file/dd2d9491740e4fec83329.png" /></p>
<ul>
<li>下一状态的组合逻辑
<ul>
<li>当前状态和输入来决定下一状态</li>
</ul>
</li>
<li>状态寄存器
<ul>
<li>存储元件用于保持当前的状态信息</li>
<li>可以直接决定输出组合逻辑的值</li>
</ul>
</li>
<li>输出的组合逻辑
<ul>
<li>输出仅依赖于当前状态，与当前的输入无关，只会在状态发生转换的时候输出发生变化，不会因为输入的变化而变化，moore的输出相对于mealy来说有更小的延迟，因为输出的改变仅在状态的变化的时候发生。</li>
</ul>
</li>
</ul>
<h4 id="模式或序列检测器">模式或序列检测器</h4>
<p>通常情况下，mealy要比moore完成同样状态的逻辑任务的状态数少1，如果模式或序列中的比特数为 N，那么在 Mealy 中所需的状态数将为 N，在 Moore 序列检测器中为 N+1。</p>
<p>比如这里要检测011的数字序列，先绘制出状态转换图</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/0e1265e6ec4ba1df5aeaf.png"
        data-srcset="https://tg-image.com/file/0e1265e6ec4ba1df5aeaf.png, https://tg-image.com/file/0e1265e6ec4ba1df5aeaf.png 1.5x, https://tg-image.com/file/0e1265e6ec4ba1df5aeaf.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/0e1265e6ec4ba1df5aeaf.png"
        title="https://tg-image.com/file/0e1265e6ec4ba1df5aeaf.png" /></p>
<p>然后这里可以根据状态转换图列出状态转换表</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/62935309f12f25a2a5099.png"
        data-srcset="https://tg-image.com/file/62935309f12f25a2a5099.png, https://tg-image.com/file/62935309f12f25a2a5099.png 1.5x, https://tg-image.com/file/62935309f12f25a2a5099.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/62935309f12f25a2a5099.png"
        title="https://tg-image.com/file/62935309f12f25a2a5099.png" /></p>
<p>然后融入具体的器件，这里是D触发器，在同一个表格中化简，绘制卡诺图，最终化简出D1和D2的表达式，以及Y输出，最后根据公示绘制出我们需要的电路</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/2f8072f012d4d605b1f36.png"
        data-srcset="https://tg-image.com/file/2f8072f012d4d605b1f36.png, https://tg-image.com/file/2f8072f012d4d605b1f36.png 1.5x, https://tg-image.com/file/2f8072f012d4d605b1f36.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/2f8072f012d4d605b1f36.png"
        title="https://tg-image.com/file/2f8072f012d4d605b1f36.png" /></p>
<h2 id="导论到verilog-hdl">导论到Verilog HDL</h2>
<h3 id="verilog-hdl的基础知识">verilog HDL的基础知识</h3>
<p>verilog是一种硬件描述语言，，用于描述硬件进行仿真、综合和实现。</p>
<p>verilog 将电路描述为基本的开关到复杂的集成电路，如ROM、RAM、微控制器、微处理器以及其他的组合和时序逻辑电路。</p>
<h4 id="引入vlsi超大规模集成电路">引入VLSI超大规模集成电路</h4>
<p>是一种集成的类型，相较于分立的器件，在这一个集成类别下，数百万个晶体管被制造在单一的集成电路中，微处理器和微控制器也属于这一个VLSI类别，由于电路的复杂性，所以不可能进行验证、制造或者面包板的实验，需要使用CAD来进行验证和制造。</p>
<h4 id="模拟和数字vlsi">模拟和数字VLSI</h4>
<p>VLSI也是一种HDL，它用于模拟数字和模拟信号，但是在这里，我们只讨论数字设计。</p>
<h4 id="机器语言和hdls">机器语言和HDLs</h4>
<p>我们知道在数字系统中所有的操作都是由机器语言所执行的，机器语言和HDL在数字系统设计中起着非常重要的作用，这两种语言也在设计高频合成器的通信中被广泛使用。</p>
<h4 id="设计方法论">设计方法论</h4>
<p>主要有两种设计方法，</p>
<ul>
<li>自上而下设计方法
<ul>
<li>定义顶层设计块，然后是子级块，此外，子块被划分为叶子单元，无法在进一步划分，这种设计方法被称之为自顶向下设计方法</li>
</ul>
</li>
<li>自下向上设计方法
<ul>
<li>定义底层设计块，借助叶子单元，构建更大的宏单元，可以用于设计更高级别的块，被称之为自底向上设计方法</li>
</ul>
</li>
</ul>
<h4 id="设计流程">设计流程</h4>
<ol>
<li>
<p><strong>Specifications of Design</strong></p>
<ul>
<li>定义整个设计的要求和目标。</li>
</ul>
</li>
<li>
<p><strong>Behavioral Description</strong></p>
<ul>
<li>用高层次的硬件描述语言来表达设计的行为。</li>
</ul>
</li>
<li>
<p><strong>RTL Description</strong></p>
<ul>
<li>描述寄存器传输级别（Register Transfer Level）的设计，用于细化行为描述。</li>
</ul>
</li>
<li>
<p><strong>Functional Verification</strong></p>
<ul>
<li>通过模拟检查RTL设计是否满足行为规格。</li>
</ul>
</li>
<li>
<p><strong>Testing</strong></p>
<ul>
<li>对功能验证过程中的设计进行测试，确保没有错误。</li>
</ul>
</li>
<li>
<p><strong>Logic Synthesis</strong></p>
<ul>
<li>将RTL描述转换成门级网表。</li>
</ul>
</li>
<li>
<p><strong>Gate-Level Analysis</strong></p>
<ul>
<li>分析门级网表来确保满足时序和功耗要求。</li>
</ul>
</li>
<li>
<p><strong>Verification and Testing</strong></p>
<ul>
<li>在门级阶段对设计进行验证和测试。</li>
</ul>
</li>
<li>
<p><strong>Floor Planning</strong></p>
<ul>
<li>对芯片的物理结构进行初步规划，包括模块布局和互连。</li>
</ul>
</li>
<li>
<p><strong>Physical Layout</strong></p>
<ul>
<li>根据floor planning，创建设计的详细物理布局。</li>
</ul>
</li>
<li>
<p><strong>Layout Verification</strong></p>
<ul>
<li>使用DRC（Design Rule Check）、LVS（Layout vs. Schematic Check）等工具验证布局。</li>
</ul>
</li>
<li>
<p><strong>Final Implementation</strong></p>
<ul>
<li>最终实现，准备设计用于制造。</li>
</ul>
</li>
</ol>
<h3 id="抽象级别和建模的概念">抽象级别和建模的概念</h3>
<p>verilog是一种行为、结构描述语言，内部的抽象级别可以分为四种级别</p>
<h4 id="门电路级">门电路级</h4>
<p>模块使用逻辑门来设计，通过网络来相互连接，类似于焖鸡图，电路简单的时候可以用于设计</p>
<h4 id="数据流级">数据流级</h4>
<p>数据抽象层，用特定的数据流来进行设计，我们知道硬件寄存器之间的数据流和在电路中的数据的处理方式</p>
<h4 id="行为级">行为级</h4>
<p>也称之为算法级，是最高级别的抽象层，可以使用所需的算法设计模块，而不需要担心硬件的细节，类似于使用C语言来编程，但是两者的本质完全不同，不可混淆。</p>
<h4 id="开关级">开关级</h4>
<p>是最低的抽象，设计在开关、存储节点、互联的线之间实现，可以了解verilog VS的开关级别的实现，但是设计复杂电路很困难，通常用于设计低功耗设备。</p>
<h3 id="基础语法规定">基础语法规定</h3>
<ul>
<li>注释</li>
<li>占位符</li>
<li>标志符</li>
<li>转义字符</li>
<li>关键字（小写）</li>
<li>字符串</li>
<li>运算符</li>
<li>数字</li>
</ul>
<h3 id="数据类型">数据类型</h3>
<ul>
<li>值</li>
<li>线网wire</li>
<li>寄存器reg</li>
<li>向量
<ul>
<li>多个位宽的可以表示为向量，寄存器或者网络也可以表示为向量，左侧的数字将是向量的最高有效位</li>
</ul>
</li>
<li>整数数据类型integer</li>
<li>实数数据类型real</li>
<li>时间数据类型$time</li>
<li>数组</li>
<li>memory
<ul>
<li>可以在verilog中表示为一组寄存器，每个单元被称之为一个字，一个字可能是1或者很多bits</li>
</ul>
</li>
</ul>
<h3 id="testbench-概念">testbench 概念</h3>
<p>也被称之为激发信号，main module用于生成设计的RTL，testbench用于生成波形来验证设计的输出是否达到要求，设计可以根据抽象的程度不同来发生更改，但是测试的建模都是相通的。</p>
<h2 id="verilog中的编程技术">Verilog中的编程技术</h2>
<p>Verilog描述硬件，C语言描述软件，在Verliog中，语句是并行执行的，而在其他语句中是顺序执行的。基本的结构是在module中构建的，定义了输入和输出，最后被映射到电路的实际的硬件逻辑门。</p>
<h4 id="电路的门级模型">电路的门级模型</h4>
<p>通常直接从Verilog的可用库调用，逻辑门与硬件原理图有一一对应的关系，被认为是设计模型的最低级别。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/7dd480bd5caa9705bef0f.png"
        data-srcset="https://tg-image.com/file/7dd480bd5caa9705bef0f.png, https://tg-image.com/file/7dd480bd5caa9705bef0f.png 1.5x, https://tg-image.com/file/7dd480bd5caa9705bef0f.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/7dd480bd5caa9705bef0f.png"
        title="https://tg-image.com/file/7dd480bd5caa9705bef0f.png" /></p>
<p>一个带有与、或、非门的逻辑电路</p>
<h3 id="组合逻辑电路-2">组合逻辑电路</h3>
<p>输出取决于当前输入的组合，而不取决于先前的输入的电路称之为组合逻辑电路，由逻辑门、输入变量和输出变量组成。</p>
<h4 id="加法器和减法器">加法器和减法器</h4>
<h5 id="加法器">加法器</h5>
<h6 id="半加器">半加器</h6>
<p>$$S = A \overline{B} + \overline{A} B = A \oplus B \text{ and } C = AB
$$
两个输入A、B，两个输出，S和C，分别为和以及进位标志</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">HA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">output</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">xor</span> <span class="n">X_2</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span> <span class="c1">//实例化异或
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">and</span> <span class="n">A_2</span><span class="err">（</span><span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>也可以使用NAND来构建半加器。如图所示</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/301229c74db56a36a0ce6.png"
        data-srcset="https://tg-image.com/file/301229c74db56a36a0ce6.png, https://tg-image.com/file/301229c74db56a36a0ce6.png 1.5x, https://tg-image.com/file/301229c74db56a36a0ce6.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/301229c74db56a36a0ce6.png"
        title="https://tg-image.com/file/301229c74db56a36a0ce6.png" /></p>
<p>代码实现如图</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">HA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">nand</span> <span class="n">N_1</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nand</span> <span class="n">N_2</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">W1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nand</span> <span class="n">N_3</span><span class="p">(</span><span class="n">W3</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nand</span> <span class="n">N_4</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nand</span> <span class="n">N_5</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>也可以使用NOR，如图，</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/3ba9176ba32b7daf4345b.png"
        data-srcset="https://tg-image.com/file/3ba9176ba32b7daf4345b.png, https://tg-image.com/file/3ba9176ba32b7daf4345b.png 1.5x, https://tg-image.com/file/3ba9176ba32b7daf4345b.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/3ba9176ba32b7daf4345b.png"
        title="https://tg-image.com/file/3ba9176ba32b7daf4345b.png" /></p>
<p>代码实现如下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">HA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">nor</span> <span class="n">N_1</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nor</span> <span class="n">N_2</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nor</span> <span class="n">N_3</span><span class="p">(</span><span class="n">W3</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nor</span> <span class="n">N_4</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nor</span> <span class="n">N_5</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h6 id="全加器">全加器</h6>
<p>多了一个进位输入Cin相较于半加器，通过真值表可以得出表达式化简
$$\begin{align*}
S &amp;= A\overline{B}C_{\text{in}} + A\overline{B}C_{\text{in}}&rsquo; + AB&rsquo;C_{\text{in}}&rsquo; + ABC_{\text{in}} \
&amp;= A \oplus B \oplus C_{\text{in}} \
\text{and } Co &amp;= A\overline{B}C_{\text{in}} + AB&rsquo;C_{\text{in}}&rsquo; + ABC_{\text{in}} \
&amp;= AB + BC_{\text{in}} + AC_{\text{in}}
\end{align*}
$$</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/84c0a3ca62d7ce4a8d2d2.png"
        data-srcset="https://tg-image.com/file/84c0a3ca62d7ce4a8d2d2.png, https://tg-image.com/file/84c0a3ca62d7ce4a8d2d2.png 1.5x, https://tg-image.com/file/84c0a3ca62d7ce4a8d2d2.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/84c0a3ca62d7ce4a8d2d2.png"
        title="https://tg-image.com/file/84c0a3ca62d7ce4a8d2d2.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">FA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Cin</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Co</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Cin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">S</span><span class="p">,</span> <span class="n">Co</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">xor</span> <span class="n">X_1</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">A_1</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">A_2</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">A_3</span><span class="p">(</span><span class="n">W3</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">or</span> <span class="n">O_1</span><span class="p">(</span><span class="n">Co</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h5 id="减法器subtractor">减法器subtractor</h5>
<h6 id="半减器">半减器</h6>
<p>同上</p>
<h6 id="全减器">全减器</h6>
<p>根据真值表得出表达式并化简
$$\begin{align*}
D &amp;= A\overline{B}C_{\text{in}} + A\overline{B}C_{\text{in}}&rsquo; + AB&rsquo;C_{\text{in}}&rsquo; + ABC_{\text{in}} \
&amp;= A \oplus B \oplus C_{\text{in}} \
\text{and } Bo &amp;= A\overline{B}C_{\text{in}} + A\overline{B}C_{\text{in}}&rsquo; + ABC_{\text{in}} \
&amp;= A\overline{B} + BC_{\text{in}} + AC_{\text{in}}
\end{align*}
$$
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/520d45c485de8b846c96a.png"
        data-srcset="https://tg-image.com/file/520d45c485de8b846c96a.png, https://tg-image.com/file/520d45c485de8b846c96a.png 1.5x, https://tg-image.com/file/520d45c485de8b846c96a.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/520d45c485de8b846c96a.png"
        title="https://tg-image.com/file/520d45c485de8b846c96a.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">FS</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Bo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">D</span><span class="p">,</span> <span class="n">Bo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">W4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">xor</span> <span class="n">X_1</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">not</span> <span class="n">n_1</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">A_1</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">A_2</span><span class="p">(</span><span class="n">W3</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">A_3</span><span class="p">(</span><span class="n">W4</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">or</span> <span class="n">O_1</span><span class="p">(</span><span class="n">Bo</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">W4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="多路复用器mux和解多路复用器">多路复用器mux和解多路复用器</h4>
<h5 id="多路复用器mux">多路复用器mux</h5>
<p>选择信号将选择唯一的输入信号作为输出信号输出，</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/06141d0dae11e4be49547.png"
        data-srcset="https://tg-image.com/file/06141d0dae11e4be49547.png, https://tg-image.com/file/06141d0dae11e4be49547.png 1.5x, https://tg-image.com/file/06141d0dae11e4be49547.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/06141d0dae11e4be49547.png"
        title="https://tg-image.com/file/06141d0dae11e4be49547.png" />
一个2选1 mux电路逻辑图</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">mux_2x1</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">not</span> <span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">W1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">W3</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">or</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>4选1 的mux电路图</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/22e2ff0b54fa2fb15cea1.png"
        data-srcset="https://tg-image.com/file/22e2ff0b54fa2fb15cea1.png, https://tg-image.com/file/22e2ff0b54fa2fb15cea1.png 1.5x, https://tg-image.com/file/22e2ff0b54fa2fb15cea1.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/22e2ff0b54fa2fb15cea1.png"
        title="https://tg-image.com/file/22e2ff0b54fa2fb15cea1.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">mux_4x1</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w4</span><span class="p">,</span> <span class="n">w5</span><span class="p">,</span> <span class="n">w6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">not</span> <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">S1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">not</span> <span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">S0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">w3</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">w4</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">S0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">w5</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">w6</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">or</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w4</span><span class="p">,</span> <span class="n">w5</span><span class="p">,</span> <span class="n">w6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h5 id="解多路复用器">解多路复用器</h5>
<p>1*2 解多路复用器
一个输入，一个选择线，两个输出线，根据选择线，将输入在输出端反映
电路图
verilog代码</p>
<h4 id="解码器和编码器">解码器和编码器</h4>
<h5 id="解码器">解码器</h5>
<p>也称为译码器，
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/df8f835dc307c2ea19fa9.png"
        data-srcset="https://tg-image.com/file/df8f835dc307c2ea19fa9.png, https://tg-image.com/file/df8f835dc307c2ea19fa9.png 1.5x, https://tg-image.com/file/df8f835dc307c2ea19fa9.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/df8f835dc307c2ea19fa9.png"
        title="https://tg-image.com/file/df8f835dc307c2ea19fa9.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">Dec_2to4</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">not</span> <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">not</span> <span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">D0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">D1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">D2</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">(</span><span class="n">D3</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h5 id="编码器">编码器</h5>
<p>电路图
代码表达</p>
<h4 id="比较器">比较器</h4>
<p>一个1位比较器，有两个输入A，B和三个输出，大于、小、和于等于。
电路图
代码</p>
<h2 id="verilog-中的编程技术2">Verilog 中的编程技术2</h2>
<h3 id="verilog中的编程技术2">verilog中的编程技术2</h3>
<p>本章描述电路的数据流模型</p>
<h3 id="电路的数据流模型">电路的数据流模型</h3>
<p>数据流模型用运算符描述输出变量的布尔函数，数据从寄存器流向寄存器（所以这个是RTL级？）</p>
<p>可以用更少的设计步骤，一般用多个运算符来产生期望的结果，用assign 来进行连续赋值。</p>
<h3 id="组合电路的数据流类型">组合电路的数据流类型</h3>
<h4 id="加法器和减法器-1">加法器和减法器</h4>
<p>半加器代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">Half_Add</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">S</span> <span class="o">=</span> <span class="n">X</span> <span class="o">^</span> <span class="n">Y</span><span class="p">;</span>  <span class="c1">// 异或操作，计算和
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">assign</span> <span class="n">C</span> <span class="o">=</span> <span class="n">X</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="p">;</span>  <span class="c1">// 与操作，计算进位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>半减器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">Half_Subtractor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span> <span class="o">^</span> <span class="n">Y</span><span class="p">;</span>  <span class="c1">// 异或操作，计算差值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">assign</span> <span class="n">B</span> <span class="o">=</span> <span class="o">~</span><span class="n">X</span> <span class="o">&amp;</span> <span class="n">Y</span><span class="p">;</span> <span class="c1">// 与非操作，计算借位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="多路复用器">多路复用器</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">mux_2x1_df</span><span class="p">(</span><span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">S</span> <span class="o">&amp;</span> <span class="n">I0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">S</span> <span class="o">&amp;</span> <span class="n">I1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>4to1 mux</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">mux_4x1</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">s0</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">s1</span> <span class="o">&amp;</span> <span class="n">i0</span><span class="p">)</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="n">s0</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">s1</span> <span class="o">&amp;</span> <span class="n">i1</span><span class="p">)</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="o">~</span><span class="n">s0</span> <span class="o">&amp;</span> <span class="n">s1</span> <span class="o">&amp;</span> <span class="n">i2</span><span class="p">)</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">               <span class="p">(</span><span class="n">s0</span> <span class="o">&amp;</span> <span class="n">s1</span> <span class="o">&amp;</span> <span class="n">i3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>条件运算符也可以用来描述多路复用器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"></code></pre></div><p>4to1 mux</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"></code></pre></div><h4 id="译码器">译码器</h4>
<p>根据公式用verilog写出表达式</p>
<h4 id="比较器-1">比较器</h4>
<p>同上</p>
<h4 id="testbench">testbench</h4>
<p>testbench的目的是仿真，不需要有物理的实现。仿真器把一系列的输入信号应用在verilog编写的电路设计上。testbench被纳入verilog的module块来进行测试，initial来定义输入，模拟的时候，要把中间的值用reg来写符号，输入和输出用wire来定义。仿真结束的时候需要用到$finish 或者 $stop 来决定。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">ckt_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 假设模块名称为Module_nameCKT，需要替换成实际使用的模块名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Module_nameCKT</span> <span class="n">inst</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> <span class="n">C</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span> <span class="n">C</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">100</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="半加器和testbench-的数据流模型">半加器和testbench 的数据流模型</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Testbench for Half adder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">HA_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the Half Adder module, assuming it is named Half_Add
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Half_Add</span> <span class="n">Half</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">A</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">A</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">A</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p><strong>输入的A, B 需要在initial块内被赋予新的值来定义输入，所以这里被定义为reg类型，而输出不需要被定义输出，是用来测试模块输出结果的，所以定义为wire型。</strong></p>
<h4 id="半减法器的testbench和数据流">半减法器的testbench和数据流</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">HS_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="kt">reg</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">wire</span> <span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">Half_S</span> <span class="n">Half</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">initial</span>
</span></span><span class="line"><span class="cl">	<span class="k">begin</span>
</span></span><span class="line"><span class="cl">		<span class="n">X</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">Y</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">#</span><span class="mh">5</span> <span class="n">X</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">Y</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">#</span><span class="mh">5</span> <span class="n">X</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">Y</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">#</span><span class="mh">5</span> <span class="n">X</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">Y</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">#</span><span class="mh">5</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span> 
</span></span></code></pre></div><h4 id="21-mux的数据流模型和testbench">2*1 mux的数据流模型和testbench</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Testbench of 2 x 1 mux
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">mux_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the 2x1 multiplexer module, assuming its name is mux_2x1_df
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">mux_2x1_df</span> <span class="n">Mux</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Test sequence
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">I0</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span> <span class="n">I1</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> <span class="c1">// Set inputs
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">#</span><span class="mh">5</span> <span class="n">S</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>          <span class="c1">// Set select to choose I0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">#</span><span class="mh">5</span> <span class="n">S</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>          <span class="c1">// Set select to choose I1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">#</span><span class="mh">5</span> <span class="nb">$stop</span><span class="p">;</span>             <span class="c1">// Stop simulation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="41-mux的数据流模型和testbench">4*1 mux的数据流模型和testbench</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Testbench of 4 x 1 mux
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">mux_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the 4x1 multiplexer module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">mux_4x1</span> <span class="n">Mux</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Initialize inputs
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">I0</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">I1</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">I2</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">I3</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">S1</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">S0</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">S1</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">S0</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">S1</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">S0</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">S1</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">S0</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="nb">$finish</span><span class="p">;</span> <span class="c1">// End simulation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="2-4译码器数据流模型和testbench">2-4译码器数据流模型和testbench</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Testbench of 2-to-4 Decoder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">Dec_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the 2-to-4 Decoder module, assuming it is named Dec_2to4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Dec_2to4</span> <span class="n">Dec</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">D0</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">A</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">A</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">A</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="nb">$finish</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h2 id="verilog中的编程技术3">verilog中的编程技术3</h2>
<p>行为级描述可以进行组合和时序电路的设计，每个语句的执行都是通过触发信号来实现的，是通过always或者initial来启动语句执行的，所以又称为过程语句。</p>
<p>initial在仿真期间只执行一次，从时间0开始执行，always也是从一开始执行，但是会重复循环执行直至时间结束。</p>
<p>在always或者initial中的多个语句都是在关键字begin和end之间分组的。</p>
<p>一个时钟的例子, 每5个时间单位一个翻转信号</p>
<pre tabindex="0"><code>always @posedgeclk
#5 clk &lt;= ~ clk;
</code></pre><p>使用 <code>&lt;=</code> 是创建一个非阻塞赋值（Non-Blocking Assignment, NBA），这通常在 <code>always</code> 块中用于模拟时钟或其他时序行为。而连续赋值语句，使用 <code>assign</code> 关键字和 <code>=</code> 操作符，是用于描述组合逻辑的，不应该用于在 <code>always</code> 块中描述时钟信号。
<strong>阻塞赋值（<code>=</code>）</strong>：</p>
<ul>
<li>在执行时，会立即更新右侧表达式的值到左侧的变量。</li>
<li>如果在同一个过程块中连续使用多个阻塞赋值，后一个赋值会看到前一个赋值的结果。</li>
<li>这种立即执行的特性使得阻塞赋值像软件编程中的顺序执行。</li>
</ul>
<p><strong>非阻塞赋值（<code>&lt;=</code>）</strong>：</p>
<ul>
<li>在当前时刻计算右侧表达式的值，但是直到当前过程块的所有操作都计算完毕后，才会在过程块结束时同时更新所有左侧的变量。</li>
<li>这种延迟更新的特性使得多个非阻塞赋值可以模拟硬件中并行的行为。</li>
</ul>
<h3 id="组合电路的行为模型">组合电路的行为模型</h3>
<h4 id="使用if-else的半加器行为模型">使用if-else的半加器行为模型</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">half_adder</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">A</span> <span class="k">or</span> <span class="n">B</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">A</span> <span class="o">==</span> <span class="mh">1</span> <span class="o">&amp;&amp;</span> <span class="n">B</span> <span class="o">==</span> <span class="mh">1</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">C</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">A</span> <span class="o">==</span> <span class="mh">1</span> <span class="o">||</span> <span class="n">B</span> <span class="o">==</span> <span class="mh">1</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">C</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span> <span class="k">else</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">C</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="用半加器组成的全加器行为建模代码">用半加器组成的全加器行为建模代码</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">fulladder</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">S1</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the half adders
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">halfadder</span> <span class="n">HA1</span><span class="p">(</span><span class="n">S1</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">halfadder</span> <span class="n">HA2</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">or</span> <span class="n">g1</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">D2</span><span class="p">,</span> <span class="n">D1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="4位全加器的行为建模代码">4位全加器的行为建模代码</h4>
<p>纹波加法器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">bit_adder</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">C0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">C4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the full adder modules
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">fulladder</span> <span class="n">FA0</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">C1</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">C0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">              <span class="n">FA1</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">C2</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">C1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">              <span class="n">FA2</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">C3</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">C2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">              <span class="n">FA3</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">C4</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">C3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="多路复用器的行为模型">多路复用器的行为模型</h4>
<p>多路复用器也被称为数据选择器</p>
<h5 id="21-多路复用器的行为代码">2*\1 多路复用器的行为代码</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">//if-else
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">mux2x1_bh</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">OUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">select</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">OUT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">select</span> <span class="k">or</span> <span class="n">A</span> <span class="k">or</span> <span class="n">B</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">select</span> <span class="o">==</span> <span class="mh">1</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">            <span class="n">OUT</span> <span class="o">=</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> 
</span></span><span class="line"><span class="cl">            <span class="n">OUT</span> <span class="o">=</span> <span class="n">A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//case
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">mux2x1</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">select</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">A</span> <span class="k">or</span> <span class="n">B</span> <span class="k">or</span> <span class="n">select</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">(</span><span class="n">select</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="mh">1</span><span class="mb">&#39;b0</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">1</span><span class="mb">&#39;b1</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">endcase</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h5 id="41-mux的行为代码">4*1 mux的行为代码</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// instantiate 3 2-1muxs into 1 4to1 mux
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">Mux_4X1</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">I</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate 2x1 multiplexers
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">mux2x1_bh</span> <span class="n">M0</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">I</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">C1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">              <span class="n">M1</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">I</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">C2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">              <span class="n">M2</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">S</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// case
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">mux4x1</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">i0</span> <span class="k">or</span> <span class="n">i1</span> <span class="k">or</span> <span class="n">i2</span> <span class="k">or</span> <span class="n">i3</span> <span class="k">or</span> <span class="n">S</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">(</span><span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b00</span><span class="o">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">i0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b01</span><span class="o">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">i1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b10</span><span class="o">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">i2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b11</span><span class="o">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">i3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">endcase</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="2-4译码器的行为模型">2-4译码器的行为模型</h4>
<p>分别用if-else和case两种方式表达</p>
<h4 id="4-2编码器的行为模型">4-2编码器的行为模型</h4>
<p>分别用if-else和case两种方式表达</p>
<h3 id="时序电路的行为模型">时序电路的行为模型</h3>
<h4 id="d锁存器的行为建模">D锁存器的行为建模</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// D-latch verilog
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">d_latch</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">en</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">d</span><span class="p">,</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">en</span> <span class="k">or</span> <span class="n">d</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">en</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">q</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// D-latch testbench
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">d_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">d</span><span class="p">,</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the D-Latch
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">d_latch</span> <span class="n">D1</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">en</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Initial block for setting initial values and finishing the simulation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">en</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">40</span> <span class="nb">$finish</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Toggle `en` every 5 time units
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">always</span> <span class="p">#</span><span class="mh">5</span> <span class="n">en</span> <span class="o">=</span> <span class="o">~</span><span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Toggle `d` every 7 time units
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">always</span> <span class="p">#</span><span class="mh">7</span> <span class="n">d</span> <span class="o">=</span> <span class="o">~</span><span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>这里是在模拟的testbench中，不需要用到&quot; &lt;= &quot; 来写时钟信号变化，描述硬件行为的时候，要模拟硬件的并行行为，所以要用&quot; &lt;= &ldquo;，生成测试信号的时候，立即改变信号的值，用阻塞赋值的刺激是适当的。</p>
<h3 id="d触发器的行为建模">D触发器的行为建模</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// D-ff 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">d_ff</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">rst</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span> <span class="k">or</span> <span class="k">negedge</span> <span class="n">rst</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">rst</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">q</span> <span class="o">&lt;=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span> <span class="k">else</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">q</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// D-ff testbench
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">d_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">clk</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the D-FF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">d_ff</span> <span class="n">D1</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">rst</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Initialize signals and run the simulation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">clk</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="n">rst</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="n">d</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">rst</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">7</span> <span class="n">rst</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">13</span> <span class="n">rst</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">40</span> <span class="nb">$finish</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Toggle clock signal every 3 time units
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">always</span> <span class="p">#</span><span class="mh">3</span> <span class="n">clk</span> <span class="o">=</span> <span class="o">~</span><span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Toggle data signal every 5 time units
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">always</span> <span class="p">#</span><span class="mh">5</span> <span class="n">d</span> <span class="o">=</span> <span class="o">~</span><span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="jk触发器的行为建模">JK触发器的行为建模</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">JK</span> <span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">clk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">q1</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">({</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b00</span><span class="o">:</span> <span class="k">begin</span> <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="p">;</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">q1</span><span class="p">;</span> <span class="k">end</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b01</span><span class="o">:</span> <span class="k">begin</span> <span class="n">q</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> <span class="n">q1</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span> <span class="k">end</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b10</span><span class="o">:</span> <span class="k">begin</span> <span class="n">q</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span> <span class="n">q1</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> <span class="k">end</span>
</span></span><span class="line"><span class="cl">            <span class="mh">2</span><span class="mb">&#39;b11</span><span class="o">:</span> <span class="k">begin</span> <span class="n">q</span> <span class="o">=</span> <span class="o">~</span><span class="n">q</span><span class="p">;</span> <span class="n">q1</span> <span class="o">=</span> <span class="o">~</span><span class="n">q1</span><span class="p">;</span> <span class="k">end</span>
</span></span><span class="line"><span class="cl">        <span class="k">endcase</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// testbench
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">JK_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">clk</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the JK flip-flop
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">JK</span> <span class="n">J1</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">clk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Initialize signals and run the simulation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">clk</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">25</span> <span class="nb">$finish</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Toggle clock signal every 2 time units
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">always</span> <span class="p">#</span><span class="mh">2</span> <span class="n">clk</span> <span class="o">=</span> <span class="o">~</span><span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="使用jk触发器来完成d触发器的行为建模">使用JK触发器来完成D触发器的行为建模</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/c693ddbb5e7499b29e771.png"
        data-srcset="https://tg-image.com/file/c693ddbb5e7499b29e771.png, https://tg-image.com/file/c693ddbb5e7499b29e771.png 1.5x, https://tg-image.com/file/c693ddbb5e7499b29e771.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/c693ddbb5e7499b29e771.png"
        title="https://tg-image.com/file/c693ddbb5e7499b29e771.png" /></p>
<p>输入 J 和 K 之间使用了一个反相器。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">d_ff</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Inverting D to use as the K input for the JK flip-flop
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">not</span> <span class="n">N_1</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiating the JK flip-flop with the D input wired to J,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// the inverted D wired to K, and the clock.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// The Q and Q_bar outputs from the JK flip-flop will serve as the
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// D-type flip-flop&#39;s outputs.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">JK</span> <span class="n">JK_d</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">clk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="使用jk触发器来完成t触发器的行为建模">使用JK触发器来完成T触发器的行为建模</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/947ca8c01a11e28379515.png"
        data-srcset="https://tg-image.com/file/947ca8c01a11e28379515.png, https://tg-image.com/file/947ca8c01a11e28379515.png 1.5x, https://tg-image.com/file/947ca8c01a11e28379515.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/947ca8c01a11e28379515.png"
        title="https://tg-image.com/file/947ca8c01a11e28379515.png" /></p>
<p>JK短接在一起</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">T_ff</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">T</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// q_bar is the inverse of q
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">wire</span> <span class="n">q_bar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">q_bar</span> <span class="o">=</span> <span class="o">~</span><span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the JK flip-flop with both J and K inputs tied to T
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// When J and K are both high, the JK flip-flop toggles - which is the behavior of T flip-flop
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">JK</span> <span class="n">JK_d</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">clk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="使用jk触发器对sr触发器建模">使用JK触发器对SR触发器建模</h3>
<p>不可以SR同时为1</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/c26c7d08efcbd1701c997.png"
        data-srcset="https://tg-image.com/file/c26c7d08efcbd1701c997.png, https://tg-image.com/file/c26c7d08efcbd1701c997.png 1.5x, https://tg-image.com/file/c26c7d08efcbd1701c997.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/c26c7d08efcbd1701c997.png"
        title="https://tg-image.com/file/c26c7d08efcbd1701c997.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">SR_ff</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">R</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">q_bar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// q_bar is the complement of q
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">assign</span> <span class="n">q_bar</span> <span class="o">=</span> <span class="o">~</span><span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the JK flip-flop
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// The J and K inputs are connected to the S and R inputs respectively.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// Note that this JK instantiation assumes that the JK flip-flop has a 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// built-in mechanism to handle the invalid state when J and K are both high.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">JK</span> <span class="n">JK_SR</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q_bar</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">clk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">q_bar</span> <span class="o">=</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h2 id="使用开关进行数字设计">使用开关进行数字设计</h2>
<p>开关级模型相当复杂，电路是在晶体管级别设计的。设计可以使用开关进行，例如 p-通道金属-氧化物-半导体场效应晶体管 MOSFET（PMOS）、n-通道 MOSFET（NMOS）和传输门（TG）或互补 MOSFET（CMOS）。</p>
<h3 id="开关门建模">开关门建模</h3>
<p>出于对低功耗和高密度封装的需求，设计人员探索新型的低漏电电流和工作电压的MOSFET架构。</p>
<h3 id="使用cmos技术的数字设计">使用CMOS技术的数字设计</h3>
<p>MOSFET MOSFET 是一种四端器件。这四个端子是源极、漏极、栅极和基底，一般基底和源极连接，所以可以看作三端器件。用于开关和放大电子信号。 电压施加在栅极上，控制从源到漏的电流流动。</p>
<p>电子的较高迁移率导致 NMOS 成为比 PMOS 更合适的选择，后者具有较低的空穴迁移率。电路网络可以概括的分为上拉和下拉网络，负责把信号拉到1和0，可以有多个pmos 或者nmos组成。具体取决于公式的实现。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/36aa80306e58e1eaf083c.png"
        data-srcset="https://tg-image.com/file/36aa80306e58e1eaf083c.png, https://tg-image.com/file/36aa80306e58e1eaf083c.png 1.5x, https://tg-image.com/file/36aa80306e58e1eaf083c.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/36aa80306e58e1eaf083c.png"
        title="https://tg-image.com/file/36aa80306e58e1eaf083c.png" /></p>
<p>For, $$( F = \overline{A \cdot B \cdot C \ldots} )$$</p>
<p>NMOS will be series connected in a pull-down network and PMOS will, in parallel, be connected in a pull-up network.</p>
<p>For, $$( F = \overline{(A + B + C \ldots)} )$$</p>
<p>NMOS will be connected in parallel in the pull-down network and PMOS will be series connected in a pull-up network.</p>
<h2 id="cmos-反相器">CMOS 反相器</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/1e23162cb7711a33721fd.png"
        data-srcset="https://tg-image.com/file/1e23162cb7711a33721fd.png, https://tg-image.com/file/1e23162cb7711a33721fd.png 1.5x, https://tg-image.com/file/1e23162cb7711a33721fd.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/1e23162cb7711a33721fd.png"
        title="https://tg-image.com/file/1e23162cb7711a33721fd.png" /></p>
<h3 id="使用开关设计和实现组合逻辑电路">使用开关设计和实现组合逻辑电路</h3>
<p>verilog有一个开关的库文件，包含可以用于实现逻辑的晶体管级开关，这一特性对于电路内部的连接和摆放大有裨益。</p>
<h4 id="开关的种类">开关的种类</h4>
<p>原语：此处的实例化名称可选
nmos n1 (drain, source, gate); //syntax for NMOS switch instantiation
pmos p1(drain, source, gate); //syntax for PMOS switch instantiation</p>
<h4 id="cmos开关">CMOS开关</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/3862a20485c50a0b6fbfb.png"
        data-srcset="https://tg-image.com/file/3862a20485c50a0b6fbfb.png, https://tg-image.com/file/3862a20485c50a0b6fbfb.png 1.5x, https://tg-image.com/file/3862a20485c50a0b6fbfb.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/3862a20485c50a0b6fbfb.png"
        title="https://tg-image.com/file/3862a20485c50a0b6fbfb.png" /></p>
<p>cmos c1(Out, In, ngate, pgate); //syntax for CMOS switch instantiation</p>
<p>cmos原语用一个pmos和nmos组成了一个传输门</p>
<h4 id="电阻开关">电阻开关</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/1148685eabd45d37cbdb4.png"
        data-srcset="https://tg-image.com/file/1148685eabd45d37cbdb4.png, https://tg-image.com/file/1148685eabd45d37cbdb4.png 1.5x, https://tg-image.com/file/1148685eabd45d37cbdb4.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/1148685eabd45d37cbdb4.png"
        title="https://tg-image.com/file/1148685eabd45d37cbdb4.png" /></p>
<p>r为前缀的开关，意味着具有更高阻抗的mos开关，和常规的开关不同。在双向电阻性开关中（例如<code>rtran</code>，<code>rtranif0</code>和<code>rtranif1</code>），电阻性质同样重要，这种开关允许信号在两个方向上以较高阻抗状态传输。
Keywords of resistive switches are:
rnmos //resistive NMOS switch
rpmos //resistive PMOS switch
rcmos //resistive CMOS switch
rtran // bidirectional resistive switch without control.
rtranif1 // bidirectional resistive switch with control
rtranif0 // bidirectional resistive switch with control_bar</p>
<h4 id="供电和接地需求">供电和接地需求</h4>
<p>电源和地端口分别用关键字 supply1 和 supply0 表示。
supply1 VDD; //logic 1 connected to VDD
supply0 GND; //logic 0 connected to GND</p>
<h3 id="使用开关来完成逻辑实现">使用开关来完成逻辑实现</h3>
<p>对于2输入NAND门的设计，分别需要两个PMOS和两个NMOS晶体管用于上拉和下拉网络。CMOS实现始终提供补码输出。对于NAND操作，NMOS连接在串联中，而PMOS连接在并联中。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// NAND
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">NAND_Switch</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">F</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply0</span> <span class="n">gnd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// PMOS switches connected to Vdd
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">pmos</span> <span class="n">P1</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">pmos</span> <span class="n">P2</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// NMOS switches connected in series with an intermediate node w1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">nmos</span> <span class="n">N1</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nmos</span> <span class="n">N2</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>与门需要添加一个CMOS反相器，所以需要用到6个晶体管，包括3个nmos和3个pmos
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/ef174f96daf2bd5b6f906.png"
        data-srcset="https://tg-image.com/file/ef174f96daf2bd5b6f906.png, https://tg-image.com/file/ef174f96daf2bd5b6f906.png 1.5x, https://tg-image.com/file/ef174f96daf2bd5b6f906.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/ef174f96daf2bd5b6f906.png"
        title="https://tg-image.com/file/ef174f96daf2bd5b6f906.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Verilog Program for AND using switches
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">AND_Switch</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">F</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">F1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply0</span> <span class="n">gnd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// PMOS switches connected to Vdd for pull-up network
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">pmos</span> <span class="n">P1</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">pmos</span> <span class="n">P2</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// NMOS switches connected in series for pull-down network
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">nmos</span> <span class="n">N1</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">A</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nmos</span> <span class="n">N2</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Output buffer to drive the signal F
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">pmos</span> <span class="n">P3</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">F1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nmos</span> <span class="n">N4</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">F1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>对于NOR的设计同理</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Nor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">switch_nor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Internal wires
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">wire</span> <span class="n">w1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">supply1</span> <span class="n">VDD</span><span class="p">;</span> <span class="c1">// Power (1) is connected to VDD
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">supply0</span> <span class="n">GND</span><span class="p">;</span> <span class="c1">// Ground (0) is connected to GND
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// PMOS for pull-up network
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">pmos</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">VDD</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span> <span class="c1">// When &#39;a&#39; is LOW, connect &#39;out&#39; to VDD
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">pmos</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">VDD</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="c1">// When &#39;b&#39; is LOW, connect &#39;out&#39; to VDD
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// NMOS for pull-down network
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">nmos</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span> <span class="c1">// When &#39;a&#39; is HIGH, connect &#39;out&#39; to &#39;w1&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">nmos</span> <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">GND</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="c1">// When &#39;b&#39; is HIGH, connect &#39;w1&#39; to GND
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">endmodule</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/05989783701afe46ee4da.png"
        data-srcset="https://tg-image.com/file/05989783701afe46ee4da.png, https://tg-image.com/file/05989783701afe46ee4da.png 1.5x, https://tg-image.com/file/05989783701afe46ee4da.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/05989783701afe46ee4da.png"
        title="https://tg-image.com/file/05989783701afe46ee4da.png" /></p>
<p>XOR, 可以使用 AND、OR 和 NOT 操作来实现
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/5bcaef79a68cce056cb1b.png"
        data-srcset="https://tg-image.com/file/5bcaef79a68cce056cb1b.png, https://tg-image.com/file/5bcaef79a68cce056cb1b.png 1.5x, https://tg-image.com/file/5bcaef79a68cce056cb1b.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/5bcaef79a68cce056cb1b.png"
        title="https://tg-image.com/file/5bcaef79a68cce056cb1b.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/ac9673c459ae11edf7bf5.png"
        data-srcset="https://tg-image.com/file/ac9673c459ae11edf7bf5.png, https://tg-image.com/file/ac9673c459ae11edf7bf5.png 1.5x, https://tg-image.com/file/ac9673c459ae11edf7bf5.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/ac9673c459ae11edf7bf5.png"
        title="https://tg-image.com/file/ac9673c459ae11edf7bf5.png" /></p>
<h3 id="使用双向开关来实现">使用双向开关来实现</h3>
<p>传输门是一个双向开关的实例，由cmos的pmos和nmos组成，可以表示出布尔表达式的任何逻辑表达式。</p>
<h4 id="使用开关的多路复用器">使用开关的多路复用器</h4>
<p>6个mos组成一个2-1 mux</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// 2x1 Multiplexer using CMOS switch
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">mux2x1_switch</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">s</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">s1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Instantiate the CMOS inverter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">snot</span> <span class="n">U1</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// CMOS transmission gates for multiplexer functionality
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">cmos</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">cmos</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// CMOS inverter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">snot</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">sbar</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply1</span> <span class="n">vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply0</span> <span class="n">gnd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// CMOS inverter logic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">nmos</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">gnd</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">pmos</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">vdd</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/497a9623334027888978a.png"
        data-srcset="https://tg-image.com/file/497a9623334027888978a.png, https://tg-image.com/file/497a9623334027888978a.png 1.5x, https://tg-image.com/file/497a9623334027888978a.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/497a9623334027888978a.png"
        title="https://tg-image.com/file/497a9623334027888978a.png" /></p>
<p>在verilog中不光可以使用常规的mos来组成加法器，还可以使用mux来组成加法器，而这里的mux是由cmos组成的。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/ec615c65a7a33e3b2b6e9.png"
        data-srcset="https://tg-image.com/file/ec615c65a7a33e3b2b6e9.png, https://tg-image.com/file/ec615c65a7a33e3b2b6e9.png 1.5x, https://tg-image.com/file/ec615c65a7a33e3b2b6e9.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/ec615c65a7a33e3b2b6e9.png"
        title="https://tg-image.com/file/ec615c65a7a33e3b2b6e9.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// 1-bit Full adder block using 4X1 multiplexer
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">fulladder_Mux41_cmos</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">sum</span><span class="p">,</span> <span class="n">carry</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">sum</span><span class="p">,</span> <span class="n">carry</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply0</span> <span class="n">GND</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">not</span> <span class="n">n1</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">mux41</span> <span class="n">x1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">mux41</span> <span class="n">x2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">GND</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">carry</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 4x1 Multiplexer block using switches.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">mux41</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply0</span> <span class="n">GND</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">nmos</span> <span class="n">n1</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">s0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">pmos</span> <span class="n">p1</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">GND</span><span class="p">,</span> <span class="n">s0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">nmos</span> <span class="n">n2</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">pmos</span> <span class="n">p2</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">GND</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">cmos</span> <span class="n">c1</span><span class="p">(</span><span class="n">w3</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">w1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">cmos</span> <span class="n">c2</span><span class="p">(</span><span class="n">w3</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">s0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">cmos</span> <span class="n">c3</span><span class="p">(</span><span class="n">w4</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">w1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">cmos</span> <span class="n">c4</span><span class="p">(</span><span class="n">w4</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">s0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">cmos</span> <span class="n">c5</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">cmos</span> <span class="n">c6</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">w4</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Verilog test stimulus for 1-bit Full adder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">fulladder_cmos_test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">sum</span><span class="p">,</span> <span class="n">carry</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">fulladder_Mux41_cmos</span> <span class="n">f1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">cin</span><span class="p">,</span> <span class="n">sum</span><span class="p">,</span> <span class="n">carry</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span> <span class="n">cin</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">3</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="采用结构级建模的verilog开关级描述">采用结构级建模的verilog开关级描述</h3>
<p>verilog支持用开关级电路在结构级建模，比如一个4位纹波加法器，可以用nmos和pmos精确描述之后用于子模块调用，结构化的方式写出4位纹波加法器。</p>
<h3 id="带延迟的开关模型">带延迟的开关模型</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/00e8f65589fb8a99facfc.png"
        data-srcset="https://tg-image.com/file/00e8f65589fb8a99facfc.png, https://tg-image.com/file/00e8f65589fb8a99facfc.png 1.5x, https://tg-image.com/file/00e8f65589fb8a99facfc.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/00e8f65589fb8a99facfc.png"
        title="https://tg-image.com/file/00e8f65589fb8a99facfc.png" /></p>
<h2 id="高级verilog主题">高级verilog主题</h2>
<h3 id="延迟建模和编程">延迟建模和编程</h3>
<p>实际硬件中存在不同的延迟，广义上可以分为两种类型，也就是门延迟和线路互连延迟。设计硬件的时候需要考虑延迟来匹配实际的硬件时序。随着技术的进步，时序约束变得越来越重要，因为这关系到电路工作频率的提高。</p>
<h4 id="延迟模型">延迟模型</h4>
<p>在Verilog中有三种不同类型的延迟建模：（i）分布式延迟建模（ii）集总延迟建模（iii）端到端延迟建模或路径延迟建模。</p>
<h4 id="分布式延迟模型">分布式延迟模型</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/5c15ded534e8a4c764850.png"
        data-srcset="https://tg-image.com/file/5c15ded534e8a4c764850.png, https://tg-image.com/file/5c15ded534e8a4c764850.png 1.5x, https://tg-image.com/file/5c15ded534e8a4c764850.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/5c15ded534e8a4c764850.png"
        title="https://tg-image.com/file/5c15ded534e8a4c764850.png" /></p>
<p>针对电路的每个元素都有传播延迟。以下是一个电路的延迟模型和数据流延迟模型</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Program P8.1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">distributed_delay</span> <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">F</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">or</span> <span class="p">#</span><span class="mh">3</span> <span class="n">x1</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">or</span> <span class="p">#</span><span class="mh">3</span> <span class="n">x2</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="p">#</span><span class="mh">2</span> <span class="n">x3</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Program P8.2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">distributed_delay</span> <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">F</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="p">#</span><span class="mh">3</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="p">#</span><span class="mh">3</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">C</span> <span class="o">&amp;</span> <span class="n">D</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="p">#</span><span class="mh">2</span> <span class="n">F</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">&amp;</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="集总延迟模型">集总延迟模型</h4>
<p>是特定电路或模块的总体延迟。在输出门上指定。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Program P8.3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">lumped_delay</span> <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">F</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">C</span> <span class="o">&amp;</span> <span class="n">D</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="p">#</span><span class="mh">5</span> <span class="n">F</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">&amp;</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="端到端延迟模型">端到端延迟模型</h4>
<p>单个输入到输出的延迟模型，也被称为路径延迟，用关键字specify和endspecify来引入。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Program P8.4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">path_delay</span> <span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">F</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">specify</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">A</span> <span class="o">=&gt;</span> <span class="n">F</span><span class="p">)</span> <span class="o">=</span> <span class="mh">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">B</span> <span class="o">=&gt;</span> <span class="n">F</span><span class="p">)</span> <span class="o">=</span> <span class="mh">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">C</span> <span class="o">=&gt;</span> <span class="n">F</span><span class="p">)</span> <span class="o">=</span> <span class="mh">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">D</span> <span class="o">=&gt;</span> <span class="n">F</span><span class="p">)</span> <span class="o">=</span> <span class="mh">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">endspecify</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">C</span> <span class="o">&amp;</span> <span class="n">D</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="p">#</span><span class="mh">5</span> <span class="n">F</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">&amp;</span> <span class="n">w2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="用户自定义的原语udp">用户自定义的原语UDP</h3>
<p>Verilog 具有许多内置原语，可以在模块中进行说明，如门类型（AND、NAND、OR、NOR、XOR、XNOR 等）和开关类型（NMOS、PMOS、CMOS 等）。Verilog 使用户能够创建自己的原语，称为用户定义的原语（UDP）。使用真值表来描述任何逻辑。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// 格式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">primitive</span> <span class="n">name_of_UDP</span> <span class="p">(</span><span class="k">output</span><span class="p">,</span> <span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Declaration of ports
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">output</span> <span class="kt">reg</span> <span class="k">output</span><span class="p">;</span> <span class="c1">// optional
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Initial block to set an initial value for the output
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">output</span> <span class="o">=</span> <span class="n">some_initial_value</span><span class="p">;</span> <span class="c1">// optional
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Truth table defining the behavior of the UDP
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">table</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// truth table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">endtable</span>
</span></span><span class="line"><span class="cl"><span class="k">endprimitive</span>
</span></span></code></pre></div><h4 id="组合udp">组合UDP</h4>
<p>区别在于UDP只有一个输出，组合电路可以有多个输出</p>
<h5 id="真值表格式">真值表格式</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Program P8.6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">primitive</span> <span class="n">my_and</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">table</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// a b : f
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="mh">0</span> <span class="mh">0</span> <span class="o">:</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0</span> <span class="mh">1</span> <span class="o">:</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="mh">1</span> <span class="mh">0</span> <span class="o">:</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="mh">1</span> <span class="mh">1</span> <span class="o">:</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">endtable</span>
</span></span><span class="line"><span class="cl"><span class="k">endprimitive</span>
</span></span></code></pre></div><p>写入值的顺序应与声明输入端口的顺序相同。输入给端口的值用空格隔开，输出的端口用冒号与输入分开。</p>
<h5 id="为输入端口分配的值">为输入端口分配的值</h5>
<p>x, ?</p>
<h5 id="组合udp的实例化">组合UDP的实例化</h5>
<h4 id="时序udp">时序UDP</h4>
<ul>
<li>输出端口需要被声明为reg</li>
<li>输出需要被初始化为某值，可以是0或1</li>
<li>输入值、当前输出和下一输出之间要用冒号分隔
时序UDP可以分为电平敏感和边沿敏感两种。</li>
</ul>
<h5 id="电平敏感的时序udp">电平敏感的时序UDP</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Program P8.10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">primitive</span> <span class="n">dff</span> <span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">clock</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">d</span><span class="p">,</span> <span class="n">clock</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="c1">// Set initial value of q
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">table</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// d  clock  rst : current q : next q
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">?</span>   <span class="o">?</span>      <span class="mh">1</span>   <span class="o">:</span> <span class="o">?</span>         <span class="o">:</span> <span class="mh">0</span><span class="p">;</span>  <span class="c1">// reset condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="mh">0</span>   <span class="mh">1</span>      <span class="mh">0</span>   <span class="o">:</span> <span class="o">?</span>         <span class="o">:</span> <span class="mh">0</span><span class="p">;</span>  <span class="c1">// clk level high, store 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="mh">1</span>   <span class="mh">1</span>      <span class="mh">0</span>   <span class="o">:</span> <span class="o">?</span>         <span class="o">:</span> <span class="mh">1</span><span class="p">;</span>  <span class="c1">// clk level high, store 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">?</span>   <span class="mh">0</span>      <span class="o">?</span>   <span class="o">:</span> <span class="o">?</span>         <span class="o">:</span> <span class="o">-</span><span class="p">;</span>  <span class="c1">// clk level low, no change
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">endtable</span>
</span></span><span class="line"><span class="cl"><span class="k">endprimitive</span>
</span></span></code></pre></div><h4 id="边沿敏感的时序udp">边沿敏感的时序UDP</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Primitive definition for an edge-triggered D flip-flop
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">primitive</span> <span class="n">EDff</span> <span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">q</span><span class="p">;</span>    <span class="c1">// Output of the flip-flop
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">input</span> <span class="n">d</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>  <span class="c1">// Data, clock, and reset inputs
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">reg</span> <span class="n">q</span><span class="p">;</span>       <span class="c1">// Internal storage for the output
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Set initial value of q
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">initial</span> <span class="n">q</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Define the behavior of the flip-flop with a truth table
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">table</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// d clk rst : current q : next q
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">?</span>  <span class="o">?</span>  <span class="mh">1</span>   <span class="o">:</span>  <span class="o">?</span>   <span class="o">:</span> <span class="mh">0</span><span class="p">;</span>  <span class="c1">// Reset condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">?</span> <span class="p">(</span><span class="mh">0</span><span class="o">?</span><span class="p">)</span> <span class="mh">0</span>   <span class="o">:</span>  <span class="o">?</span>   <span class="o">:</span> <span class="o">-</span><span class="p">;</span>  <span class="c1">// Ignore positive edge of the clock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">?</span> <span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="mh">0</span>   <span class="o">:</span>  <span class="o">?</span>   <span class="o">:</span> <span class="o">-</span><span class="p">;</span>  <span class="c1">// Ignore unknown positive edge of the clock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">?</span> <span class="p">(</span><span class="mh">1</span><span class="n">x</span><span class="p">)</span> <span class="mh">0</span>   <span class="o">:</span>  <span class="o">?</span>   <span class="o">:</span> <span class="o">-</span><span class="p">;</span>  <span class="c1">// Ignore unknown negative edge of the clock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="mh">1</span> <span class="p">(</span><span class="mh">10</span><span class="p">)</span> <span class="mh">0</span>   <span class="o">:</span>  <span class="o">?</span>   <span class="o">:</span> <span class="mh">1</span><span class="p">;</span>  <span class="c1">// Output follows d at negative edge of the clock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="mh">0</span> <span class="p">(</span><span class="mh">10</span><span class="p">)</span> <span class="mh">0</span>   <span class="o">:</span>  <span class="o">?</span>   <span class="o">:</span> <span class="mh">0</span><span class="p">;</span>  <span class="c1">// Output follows d at negative edge of the clock
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">(</span><span class="o">??</span><span class="p">)</span> <span class="mh">0</span> <span class="mh">0</span>   <span class="o">:</span>  <span class="o">?</span>   <span class="o">:</span> <span class="o">-</span><span class="p">;</span>  <span class="c1">// No change on d when clk is stable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">endtable</span>
</span></span><span class="line"><span class="cl"><span class="k">endprimitive</span>
</span></span></code></pre></div><p><code>?</code> 表示任意值，<code>(0?)</code> 表示0到任意值的正边沿，<code>(x1)</code> 和 <code>(1x)</code> 分别表示未知到1和1到未知的变化，<code>(10)</code> 表示从1到0的负边沿。<code>-</code> 表示输出不变。</p>
<h4 id="速记符号">速记符号</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/193de45b41b00894b78ce.png"
        data-srcset="https://tg-image.com/file/193de45b41b00894b78ce.png, https://tg-image.com/file/193de45b41b00894b78ce.png 1.5x, https://tg-image.com/file/193de45b41b00894b78ce.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/193de45b41b00894b78ce.png"
        title="https://tg-image.com/file/193de45b41b00894b78ce.png" /></p>
<h3 id="任务和函数">任务和函数</h3>
<p>在verilog 设计项目中，可能在不同的地方实现相同的步骤，可以把特定功能保存在特定位置，主程序需要时调用相同的功能，不用每次写重复的代码，这些程序或者代码通常被称为子程序，并且几乎在所有的编程语言中都得到了实现。verilog中，任务和函数可用于满足子程序的要求。</p>
<h4 id="任务和函数的区别">任务和函数的区别</h4>
<p>任务Task被定义为一组指令/语句，用于执行特定的功能，可以在设计中重复使用，比如一个任务把内容从内存上一个位置移动到另一个内存位置。再比如执行算术运算，然后结果保存在不同的内存位置。就有点像计算机指令集里面的指令。</p>
<p>函数Function通常是计算一个表达式或者公式，特定的输入集合给出单一的输出，中途可能涉及计算多次。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/50cde4983600cb7469b16.png"
        data-srcset="https://tg-image.com/file/50cde4983600cb7469b16.png, https://tg-image.com/file/50cde4983600cb7469b16.png 1.5x, https://tg-image.com/file/50cde4983600cb7469b16.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/50cde4983600cb7469b16.png"
        title="https://tg-image.com/file/50cde4983600cb7469b16.png" /></p>
<h4 id="任务和函数的语法">任务和函数的语法</h4>
<p>任务用task关键字开头，然后用endtask结束，函数以function开始，endfunction结束。</p>
<h4 id="调用任务和函数">调用任务和函数</h4>
<p>任何模块中都可以用这个格式来调用声明的任务和函数。
// Program P8.14 Task invocation Syntax
task_name(outputs_from_the_task, inputs_to_the_task);</p>
<p>// Program P8.15 Function Invocation Syntax
name_of_function(inputs_to_the_function);</p>
<h4 id="任务声明和调用的示例">任务声明和调用的示例</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Program P8.16
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">operation</span><span class="p">(</span><span class="n">ab_and</span><span class="p">,</span> <span class="n">ab_or</span><span class="p">,</span> <span class="n">ab_xor</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">ab_and</span><span class="p">,</span> <span class="n">ab_or</span><span class="p">,</span> <span class="n">ab_xor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">ab_and</span><span class="p">,</span> <span class="n">ab_or</span><span class="p">,</span> <span class="n">ab_xor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">a</span> <span class="k">or</span> <span class="n">b</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">bitwise_oper</span><span class="p">(</span><span class="n">ab_and</span><span class="p">,</span> <span class="n">ab_or</span><span class="p">,</span> <span class="n">ab_xor</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="c1">// Task Invocation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">task</span> <span class="n">bitwise_oper</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">output</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">ab_and</span><span class="p">,</span> <span class="n">ab_or</span><span class="p">,</span> <span class="n">ab_xor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">input</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">ab_and</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ab_or</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ab_xor</span> <span class="o">=</span> <span class="n">a</span> <span class="o">^</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">endtask</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>这里就很像C语言，而且给人的感觉很趋于本质。这里先用<code>bitwise_oper(ab-and, ab-or, ab-xor, a, b);</code> 调用了这个函数，实际上就是把这一部分的代码逻辑转移到文中，后面紧接着使用<code>task bitwise_oper;</code>  来声明描写了这个task，这也对应了C语言里面先写程序主体然后紧接着执行程序的时候需要声明一下函数</p>
<h4 id="函数声明和调用示例">函数声明和调用示例</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Program P8.17
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">parity</span><span class="p">(</span><span class="n">parity</span><span class="p">,</span> <span class="n">address</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">parity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">parity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">address</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">parity</span> <span class="o">=</span> <span class="n">check_parity</span><span class="p">(</span><span class="n">address</span><span class="p">);</span> <span class="c1">// function invocation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nb">$display</span><span class="p">(</span><span class="s">&#34;Parity calculated = %b&#34;</span><span class="p">,</span> <span class="n">parity</span><span class="p">);</span> <span class="c1">// function invocation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="n">check_parity</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">input</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Calculate parity by XOR&#39;ing all bits of the address
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">check_parity</span> <span class="o">=</span> <span class="o">^</span><span class="n">addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">endfunction</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>以上都是先调用然后再声明函数本身。</p>
<h2 id="可编程和可配置器件">可编程和可配置器件</h2>
<h3 id="逻辑综合">逻辑综合</h3>
<p>复杂功能的设计，往往都是在更高级的抽象层次下面完成的，比如行为或者数据流模型。逻辑综合的工程师，将设计从寄存器RTL级或者更高级的抽象层次转换为晶体管级别的网表。这些更高级的抽象层次可以让设计师更快的设计出符合要求的特定设计规范，而这仅仅借助于数字电路的算法或者真值表。</p>
<p>逻辑综合有助于更高级别的verilog模型下实现最佳的门级网表或者逻辑实现，而不需要低抽象层次需要考虑的内部的连线和逻辑底层实现。逻辑综合是一个高度自动化的过程，可以让高层次抽象转为低层次。</p>
<h4 id="技术映射">技术映射</h4>
<p>技术映射建立了逻辑描述和目标实现（底层物理实现）之间的连贯性，在技术映射之前，设计逻辑描述是可以独立于任何目标技术的。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/2f84a8f42ffe3e43333b5.png"
        data-srcset="https://tg-image.com/file/2f84a8f42ffe3e43333b5.png, https://tg-image.com/file/2f84a8f42ffe3e43333b5.png 1.5x, https://tg-image.com/file/2f84a8f42ffe3e43333b5.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/2f84a8f42ffe3e43333b5.png"
        title="https://tg-image.com/file/2f84a8f42ffe3e43333b5.png" /></p>
<h4 id="技术库">技术库</h4>
<h3 id="可编程逻辑器件的介绍">可编程逻辑器件的介绍</h3>
<p>一般逻辑器件中，硬件元素的连接都是固定的，用于执行特定的功能，例如基本的门或者组合、时序电路。</p>
<p>可编程逻辑器件（PLD）可以在制造后通过编程修改逻辑以获得不同的逻辑功能。可以借助编程设备制造复杂逻辑功能的开发原型硬件。</p>
<h4 id="prompal和pla">PROM、PAL、和PLA</h4>
<p>PROM是固定的AND平面块，后面紧跟着OR可编程块
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/8758777591ab3f6c59ae0.png"
        data-srcset="https://tg-image.com/file/8758777591ab3f6c59ae0.png, https://tg-image.com/file/8758777591ab3f6c59ae0.png 1.5x, https://tg-image.com/file/8758777591ab3f6c59ae0.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/8758777591ab3f6c59ae0.png"
        title="https://tg-image.com/file/8758777591ab3f6c59ae0.png" /></p>
<p>可编程阵列逻辑（PAL）：可编程的AND连接到固定的OR块
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/dd487e69b606ae36fdbf8.png"
        data-srcset="https://tg-image.com/file/dd487e69b606ae36fdbf8.png, https://tg-image.com/file/dd487e69b606ae36fdbf8.png 1.5x, https://tg-image.com/file/dd487e69b606ae36fdbf8.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/dd487e69b606ae36fdbf8.png"
        title="https://tg-image.com/file/dd487e69b606ae36fdbf8.png" /></p>
<p>可编程逻辑阵列（PLA）：AND和OR都可编程</p>
<h4 id="spld和cpld">SPLD和CPLD</h4>
<p>分别是simple简单PLD和complex复杂PLD。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/e54660b720a41fb1a4964.png"
        data-srcset="https://tg-image.com/file/e54660b720a41fb1a4964.png, https://tg-image.com/file/e54660b720a41fb1a4964.png 1.5x, https://tg-image.com/file/e54660b720a41fb1a4964.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/e54660b720a41fb1a4964.png"
        title="https://tg-image.com/file/e54660b720a41fb1a4964.png" /></p>
<ol>
<li>可编程的AND平面类似于带有与门和非门的译码器电路，与门和非门的数量取决于一个特定PAL块的输入线数量。</li>
<li>宏单元：包含一个固定的OR平面，一个异或门、触发器、多路复用器和三态缓冲器。下图展示了带有宏单元的PAL一般视图。<strong>异或门的作用是获得实际逻辑函数的补码形式。F/F 用于存储接收到的逻辑信息。通过多路复用器在输出阶段跟随的三态缓冲器，可以在存储状态和当前状态之间进行选择。</strong>
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/f390a4b3e2d3ef536f11d.png"
        data-srcset="https://tg-image.com/file/f390a4b3e2d3ef536f11d.png, https://tg-image.com/file/f390a4b3e2d3ef536f11d.png 1.5x, https://tg-image.com/file/f390a4b3e2d3ef536f11d.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/f390a4b3e2d3ef536f11d.png"
        title="https://tg-image.com/file/f390a4b3e2d3ef536f11d.png" /></li>
</ol>
<h3 id="可编程门阵列fpga">可编程门阵列FPGA</h3>
<p>FPGA是一种具有更多输入/输出银角和硬件组件以及非常高逻辑容量的可编程器件。FPGA提供可配置的逻辑快CLB来替代CPLD中的AND-OR块。FPGA相较于CPLD装配了大量的触发器和逻辑资源。</p>
<p>以下是一个FPGA的基本视图：
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/8751db6e7a9023143ee3b.png"
        data-srcset="https://tg-image.com/file/8751db6e7a9023143ee3b.png, https://tg-image.com/file/8751db6e7a9023143ee3b.png 1.5x, https://tg-image.com/file/8751db6e7a9023143ee3b.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/8751db6e7a9023143ee3b.png"
        title="https://tg-image.com/file/8751db6e7a9023143ee3b.png" /></p>
<p>FPGA可以处理更大的电路，例如：</p>
<ul>
<li>CLB（可编程逻辑块）</li>
<li>I/O 块（输入/输出块）</li>
<li>互连线和开关</li>
<li>提供逻辑功能的CLB</li>
<li>用于将CLB连接到I/O引脚和其他FPGA块的互连开关</li>
</ul>
<p>逻辑单元和可配置互连组成了逻辑电路的基本构建模块。</p>
<h4 id="fpga架构">FPGA架构</h4>
<p>主要模块是CLB可配置逻辑块，其实就是2或者3输入的LUT查找表，一些商用的FPGA是4甚至以上的LUT作为单元。它们都包含存储单元可以加载适当的值，**多路复用器mux,multiplexer blocks to implement any desired function of n-variables depend-
ing on the type of LUT. **。</p>
<h3 id="香农的扩展和查找表">香农的扩展和查找表</h3>
<p>LUT为什么可以表达逻辑的原理</p>
<h4 id="2输入查找表lut">2输入查找表LUT</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/d77b358784beaea0cb62d.png"
        data-srcset="https://tg-image.com/file/d77b358784beaea0cb62d.png, https://tg-image.com/file/d77b358784beaea0cb62d.png 1.5x, https://tg-image.com/file/d77b358784beaea0cb62d.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/d77b358784beaea0cb62d.png"
        title="https://tg-image.com/file/d77b358784beaea0cb62d.png" /></p>
<p>2 输入LUT由三个2 * 1多路复用器和四个寄存器（存储值）组成，任何n变量的逻辑都可以用2输入LUT实现。</p>
<h4 id="3输入查找表">3输入查找表</h4>
<p>3输入查找表由7个2-1多路复用器和8歌寄存器组成，用于存储所需变量的合适值。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/77868c88a768869e3858b.png"
        data-srcset="https://tg-image.com/file/77868c88a768869e3858b.png, https://tg-image.com/file/77868c88a768869e3858b.png 1.5x, https://tg-image.com/file/77868c88a768869e3858b.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/77868c88a768869e3858b.png"
        title="https://tg-image.com/file/77868c88a768869e3858b.png" /></p>
<p>假如这里是f= x1x2x3，把00000001写入寄存器，从左到右分别是输入信号，对应着最后的输出被引导到x3 mux作为输出。</p>
<h3 id="fpga家族">FPGA家族</h3>
<p>xilinx各种不同的产品线</p>
<h3 id="使用fpga进行编程">使用FPGA进行编程</h3>
<p>使用FPGA进行开发编程，需要有对应的开发软件，比如xilinx的 ISE或者Vivado开发套件，不同的板卡可能对应着不同的兼容的开发软件。开发的时候需要以下重要的组成：</p>
<ul>
<li>HDL源文件</li>
<li>HDL测试testbench</li>
<li>设计的约束文件（UCF或XDC文件）
设计约束文件，是通过软件提供有关板子物理引脚规划的文件。</li>
</ul>
<p>FPGA是一种让设计者可以在制造后进行配置的集成电路，主要用于数字逻辑块/系统 的快速原型设计。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/465faec6b8029b3895a46.png"
        data-srcset="https://tg-image.com/file/465faec6b8029b3895a46.png, https://tg-image.com/file/465faec6b8029b3895a46.png 1.5x, https://tg-image.com/file/465faec6b8029b3895a46.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/465faec6b8029b3895a46.png"
        title="https://tg-image.com/file/465faec6b8029b3895a46.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gu">### 设计规格 (Design Specifications)
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>设计者根据功耗、面积延迟等标准和要求被提供特定的设计规格。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">### 设计分区 (Design Partitioning)
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>设计师被允许执行设计分区，以增强灵活性和简化设计。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">### 设计输入 (Design Entry)
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>这用于将设计输入到一个ASIC设计系统中，可以通过硬件描述语言（HDL）或原理图输入来完成。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">### 功能验证 (Functional Verification)
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>在这一步中，电路设计被验证，即，系统功能是否按照预期规格运行。如果不是，则在这里更改设计输入。静态时序分析、FPGA上的批处理流程（制造）功能验证规范系统分区（对于大型系统）设计输入功能验证逻辑综合楼层规划放置及设计师的路由回注。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">### FPGA上的原型制作 (Prototyping on FPGA)
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>当后布局仿真正确完成后，可以通过在FPGA上烧录软件代码来设计原型。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">### 制造 (Manufacturing)
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>在设计出原型后，将根据设计的原型制造芯片。
</span></span></code></pre></div><h4 id="fpga的应用">FPGA的应用</h4>
<p>FPGA 最常用于航空航天、国防、便携式医疗电子产品、ASIC 原型设计、数字信号处理（DSP）、高分辨率视频、图像处理以及消费类电子产品，如显示器、开关、数码相机、多功能打印机等领域。</p>
<h3 id="asic及其应用">ASIC及其应用</h3>
<p>在需要设计特定任务或者应用的集成电路时，ASIC大规模制造的低成本相较于FPGA更有优势，与 FPGA 板上类似设计相比，功耗、延迟和集成电路面积也较小。FPGA可以作为原型验证以减少ASIC设计失败所带来的影响。</p>
<h2 id="基于verilog-hdl的项目">基于Verilog HDL的项目</h2>
<p>这里介绍一个verilog的项目，包含了从开关级到行为级的四个抽象级别 <strong>（开关级、门级、数据流RTL、行为级）</strong>。每个项目都包含了一个基本的描述，真值表和验证的结果。</p>
<h3 id="基于verilog-hdl的组合逻辑项目">基于Verilog HDL的组合逻辑项目</h3>
<p>Verilog HDL 的不同抽象级别设计任何数字电路。组合电路，如加法器、减法器、乘法器、比较器等通常是许多数字处理器的一部分。  在本节中，使用开关级、门级、数据流和行为模型介绍了一些组合电路的附加示例。</p>
<h4 id="使用开关在结构化下的全加器">使用开关在结构化下的全加器</h4>
<p>这里用AND、OR、和XOR等实现了一个开关级别的全加器。设计包含四个模块，是顶层的全加器模块和开关实现的子模块。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Main module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">Switch_fulladd</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span> <span class="c1">// Top module and port declaration
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">input</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">y1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">sxor</span> <span class="n">u1</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">sxor</span> <span class="n">u2</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">sand</span> <span class="n">u3</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">sand</span> <span class="n">u4</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">sor</span> <span class="n">u5</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Module for OR gate using switches (sor)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">sor</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="c1">// Module elaboration of OR-gate using switch (sor)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">input</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">snor</span> <span class="n">x1</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="c1">// Call of module switch NOR-gate
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">snot</span> <span class="n">x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">snor</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">output</span> <span class="n">Op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">input</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">wire</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply0</span> <span class="n">Gnd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">Gnd</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">Gnd</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">sxor</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">input</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">output</span> <span class="n">Op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w4</span><span class="p">,</span> <span class="n">w5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply0</span> <span class="n">Gnd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">w3</span><span class="p">,</span> <span class="n">Gnd</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">w4</span><span class="p">,</span> <span class="n">Gnd</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">w4</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">w5</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">w5</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">w5</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">w1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">w5</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">snot</span> <span class="n">nl</span> <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">snot</span> <span class="n">n2</span> <span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">sand</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">output</span> <span class="n">Op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">input</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">wire</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">snand</span> <span class="n">x1</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">snot</span> <span class="n">x2</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">snand</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">output</span> <span class="n">Op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">input</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">wire</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply0</span> <span class="n">Gnd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">Gnd</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">snot</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">input</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">output</span> <span class="n">Op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply1</span> <span class="n">Vdd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">supply0</span> <span class="n">Gnd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">nmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">Gnd</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">pmos</span> <span class="p">(</span><span class="n">Op</span><span class="p">,</span> <span class="n">Vdd</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="纹波全加器ripple-carry-full-adder">纹波全加器ripple-carry full adder</h4>
<p>使用结构级模型设计一个由4个1位全加器组成的4位RCFA，变量M和Cout是输出，U、V被认为是4输入变量，Cin被用于初始进位输入。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/8f563188d3a527ab98949.png"
        data-srcset="https://tg-image.com/file/8f563188d3a527ab98949.png, https://tg-image.com/file/8f563188d3a527ab98949.png 1.5x, https://tg-image.com/file/8f563188d3a527ab98949.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/8f563188d3a527ab98949.png"
        title="https://tg-image.com/file/8f563188d3a527ab98949.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">RCFA_4_bit</span> <span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">Cout</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">Cin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">Cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">C0</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 串联即可
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">fulladd</span> <span class="n">f1</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">C0</span><span class="p">,</span> <span class="n">U</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">f2</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">C1</span><span class="p">,</span> <span class="n">U</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">C0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">f3</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">C2</span><span class="p">,</span> <span class="n">U</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">C1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">f4</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">Cout</span><span class="p">,</span> <span class="n">U</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">C2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="4位进位预查加法器carry-look-ahead-adder">4位进位预查加法器carry look-ahead adder</h4>
<p>CLAs属于快速加法器的一种。这个全加器FA无需等待来自前一个FA的进位信号，但是比RCFA需要更多的硬件逻辑资源。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/82ad6ab3e2fe9915e44cb.png"
        data-srcset="https://tg-image.com/file/82ad6ab3e2fe9915e44cb.png, https://tg-image.com/file/82ad6ab3e2fe9915e44cb.png 1.5x, https://tg-image.com/file/82ad6ab3e2fe9915e44cb.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/82ad6ab3e2fe9915e44cb.png"
        title="https://tg-image.com/file/82ad6ab3e2fe9915e44cb.png" /></p>
<p>这里CLA的设计是verilog HDL平台上用数据流模型来实现的。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">carrylookahead_adder</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">Cout</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">Cin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">Cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">h0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">h3</span><span class="p">,</span> <span class="n">k3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">k0</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">k1</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">k2</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">k3</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">h0</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">V</span><span class="p">[</span><span class="mh">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">V</span><span class="p">[</span><span class="mh">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">V</span><span class="p">[</span><span class="mh">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">h3</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">V</span><span class="p">[</span><span class="mh">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">S</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">Cin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">S</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">C1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">S</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">C2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">S</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">V</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">C3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">C1</span> <span class="o">=</span> <span class="n">h0</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">k0</span> <span class="o">&amp;</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">C2</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">k1</span> <span class="o">&amp;</span> <span class="n">C1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">C3</span> <span class="o">=</span> <span class="n">h2</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">k2</span> <span class="o">&amp;</span> <span class="n">C2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">Cout</span> <span class="o">=</span> <span class="n">h3</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">k3</span> <span class="o">&amp;</span> <span class="n">C3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Test Stimulus
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">carrylookahead_adder_test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">Cin</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">Cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">carrylookahead_adder</span> <span class="n">u</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">Cout</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="nb">$monitor</span><span class="p">(</span><span class="nb">$time</span><span class="p">,</span> <span class="s">&#34;S = %d, Cout = %d, U = %b, V = %b, Cin = %b&#34;</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Cout</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">Cin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">U</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d1</span><span class="p">;</span> <span class="n">V</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d2</span><span class="p">;</span> <span class="n">Cin</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">15</span> <span class="n">U</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d2</span><span class="p">;</span> <span class="n">V</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d5</span><span class="p">;</span> <span class="n">Cin</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">15</span> <span class="n">U</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d4</span><span class="p">;</span> <span class="n">V</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d4</span><span class="p">;</span> <span class="n">Cin</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">15</span> <span class="n">U</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d3</span><span class="p">;</span> <span class="n">V</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d5</span><span class="p">;</span> <span class="n">Cin</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">20</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="4位进位保存加法器carry-save-adder-csa">4位进位保存加法器carry save adder CSA</h4>
<p>在结构级别上，1位全加器的门级模块组成4位加位保存加法器，如图所示。CSA主要用于三个或三个以上的二进制加法，例如乘法器经常执行两个以上的二进制加法，在这里已经调用一个全加器模块来实现CSA，可以使用门级或者数据流级别在单独的模块中声明。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/f309409d4cd02c770b585.png"
        data-srcset="https://tg-image.com/file/f309409d4cd02c770b585.png, https://tg-image.com/file/f309409d4cd02c770b585.png 1.5x, https://tg-image.com/file/f309409d4cd02c770b585.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/f309409d4cd02c770b585.png"
        title="https://tg-image.com/file/f309409d4cd02c770b585.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Main module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">CSA</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">cout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">c1</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">c2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">fa_10</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">s1</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span> <span class="c1">// calling of full blocks
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">fulladd</span> <span class="n">fa_11</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">s1</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mh">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">fa_12</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">s1</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mh">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">fa_13</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">s1</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mh">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">fa_20</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mh">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">fa_21</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mh">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">fa_22</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mh">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">fulladd</span> <span class="n">fa_23</span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span> <span class="n">c1</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mh">4</span><span class="p">],</span> <span class="n">cout</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">s</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="mh">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="2位数组乘法器">2位数组乘法器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">arraymultiplier_2bit</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">x1</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">x2</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mh">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">x3</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">x4</span><span class="p">(</span><span class="n">w4</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="mh">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ha</span> <span class="n">h1</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mh">1</span><span class="p">],</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ha</span> <span class="n">h2</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mh">2</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="mh">3</span><span class="p">],</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">ha</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">xor</span> <span class="n">r1</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">and</span> <span class="n">r2</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">arraymultiplier_2bit_test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">C</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">arraymultiplier_2bit</span> <span class="n">u</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d0</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d0</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d1</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d2</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="mh">2</span><span class="mi">&#39;d3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="2--2-位除法电路设计">2 * 2 位除法电路设计</h4>
<p>利用真值表和卡诺图简化，设计了一个2 * 2 位除法电路设计，遵循了除法的简单规则：0/0 = x;0/1 = 0;1/1=1/0 = x 等</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Main module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">division2x2</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">Q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">Q</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">Q</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="2位比较器">2位比较器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Main module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">comparator_2bit</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">f3</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">A</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">B</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="16位算术逻辑单元arithmetic-logic-unit-alu">16位算术逻辑单元arithmetic logic unit, ALU</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">ALU_16bit</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// s is the function select line
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">always</span> <span class="p">@(</span><span class="n">s</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d0</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d1</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d2</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d3</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">a</span> <span class="o">^</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d4</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mh">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d5</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mh">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d6</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">};</span> <span class="c1">// concatenation operator
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="mh">4</span><span class="mi">&#39;d7</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="mh">2</span><span class="p">{</span><span class="n">a</span><span class="p">}};</span> <span class="c1">// replication operator
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="mh">4</span><span class="mi">&#39;d8</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d9</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="o">~</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d10</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="o">|</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d11</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="mh">1</span><span class="p">;</span> <span class="c1">// right shift 1 bit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="mh">4</span><span class="mi">&#39;d12</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mh">1</span><span class="p">;</span> <span class="c1">// left shift 1 bit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="mh">4</span><span class="mi">&#39;d13</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="o">~</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="mh">4</span><span class="mi">&#39;d14</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span> <span class="c1">// reduction operator
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="mh">4</span><span class="mb">&#39;b1</span><span class="mh">5</span><span class="o">:</span> <span class="n">out</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">a</span> <span class="o">|</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">endcase</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="使用2-4译码器实现4-16译码器">使用2-4译码器实现4-16译码器</h4>
<p>本例中使用2-4译码器作为子模块，通过结构级和数据流模型，设计了4-16译码器电路。图中展示了具体的实现逻辑图。
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/b763350a812d0aa9d9308.png"
        data-srcset="https://tg-image.com/file/b763350a812d0aa9d9308.png, https://tg-image.com/file/b763350a812d0aa9d9308.png 1.5x, https://tg-image.com/file/b763350a812d0aa9d9308.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/b763350a812d0aa9d9308.png"
        title="https://tg-image.com/file/b763350a812d0aa9d9308.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">decoder_4x16</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">el</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 结构级
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">dec_2x4</span> <span class="n">r0</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">2</span><span class="p">],</span> <span class="n">el</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dec_2x4</span> <span class="n">r1</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dec_2x4</span> <span class="n">r2</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dec_2x4</span> <span class="n">r3</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">8</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">dec_2x4</span> <span class="n">r4</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">12</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="mh">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">dec_2x4</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="n">f0</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 数据流级
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">assign</span> <span class="n">f0</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">b</span> <span class="o">&amp;</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">f3</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span> <span class="o">&amp;</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="基于verilog-hdl设计时序电路">基于verilog HDL设计时序电路</h3>
<p>和组合电路类似，时序电路也是用不同层次的抽象来实现的，使用逻辑块、寄存器和时钟信号。行为级别模型是在时序电路中最受欢迎的方式。</p>
<h4 id="4位计数器设计">4位计数器设计</h4>
<p>计数器是一个计算脉冲的时序电路实例。这个例子中用行为级模型设计了一个计数器，可以完成向上和向下两种计数方式。</p>
<p>这里是时钟正边沿触发，一个清楚信号用于清除存储在上下计数器中不同触发器中存储的值，输入的up_down 信号用于选择向上或者向下的计数过程。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design module 异步
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">asyn_up_down</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">clock</span><span class="p">,</span> <span class="n">clear</span><span class="p">,</span> <span class="n">up_down</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clock</span><span class="p">,</span> <span class="n">clear</span><span class="p">,</span> <span class="n">up_down</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clock</span> <span class="k">or</span> <span class="k">posedge</span> <span class="n">clear</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">clear</span> <span class="o">==</span> <span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">up_down</span> <span class="o">==</span> <span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">-</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span> <span class="k">else</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">&#39;d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="基于lfsr的8-bit测试模式生成器">基于LFSR的8 bit测试模式生成器</h4>
<p>线性反馈移位寄存器（LFSRs，Linear feedback shift registers) 被用于生成随机的测试输入序列。<code>x1</code>到<code>x8</code>代表8个移位寄存器，它们通过一个时钟信号同步移位。每当时钟信号发生一个上升沿时，每个寄存器中的位就会移至下一个寄存器。图中的逻辑门（看起来像是或非门）用于产生反馈，这意味着某些寄存器的输出会以某种方式组合，然后反馈到序列的开始。LFSR的特点是可以生成具有良好统计特性的伪随机位序列，经常被应用于通信系统、密码学、以及作为内建自测试（BIST）电路的一部分来生成测试模式。这种反馈机制决定了生成序列的特性，包括周期性和随机性。
设计适当的反馈函数可以确保LFSR输出一个很长的无重复序列，直到它最终重复，理想情况下，这个周期是 $2^n - 1$，其中 $n$ 是寄存器的位数。在这个8位LFSR的例子中，最长周期是 $2^8 - 1 = 255$。</p>
<blockquote>
<p>这里让人想到广为流传的计算机里没有真正的随机数，这里也许就是产生随机数的原理（不过也有一些应用是直接弄了一个随机数的数据库）</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tg-image.com/file/26ffe7bd2a6287fec88d0.png"
        data-srcset="https://tg-image.com/file/26ffe7bd2a6287fec88d0.png, https://tg-image.com/file/26ffe7bd2a6287fec88d0.png 1.5x, https://tg-image.com/file/26ffe7bd2a6287fec88d0.png 2x"
        data-sizes="auto"
        alt="https://tg-image.com/file/26ffe7bd2a6287fec88d0.png"
        title="https://tg-image.com/file/26ffe7bd2a6287fec88d0.png" /></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">lfsr8_xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">xx0</span><span class="p">,</span> <span class="n">xx1</span><span class="p">,</span> <span class="n">xx2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">xx2</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">out</span><span class="p">[</span><span class="mh">7</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">xx1</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">xx0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">xx0</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">xx1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">,</span> <span class="k">posedge</span> <span class="n">rst</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span> <span class="o">=</span> <span class="mh">8</span><span class="mi">&#39;d00000001</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">6</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span> <span class="n">xx2</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Test Stimulus
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">lfsr_tb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">lfsr8_xor</span> <span class="n">u</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">clk</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">rst</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">15</span> <span class="n">rst</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">200</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">#</span><span class="mh">5</span> <span class="n">clk</span> <span class="o">=</span> <span class="o">~</span><span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h3 id="计数器设计">计数器设计</h3>
<p>使用行为级模型的条件或者循环语句可以轻松完成计数器设计，这里提供了实例。</p>
<h4 id="随机计数器序列为24682等等">随机计数器，序列为2，4，6，8，2等等</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">counter_random</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">&lt;=</span> <span class="mh">4</span><span class="mi">&#39;d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;</span> <span class="mh">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">&lt;=</span> <span class="n">count</span> <span class="o">+</span> <span class="mh">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">&lt;=</span> <span class="mh">4</span><span class="mi">&#39;d2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">module</span> <span class="n">counter_random_test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">counter_random</span> <span class="n">u</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">clk</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">forever</span> <span class="p">#</span><span class="mh">5</span> <span class="n">clk</span> <span class="o">=</span> <span class="o">~</span><span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">rst</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">10</span> <span class="n">rst</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">200</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Mod16 up-counter that count from 0-15
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">count_mod16</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">co</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">integer</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rst</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">co</span> <span class="o">&lt;=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">15</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mh">1</span><span class="p">)</span> <span class="c1">// use of for loop
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">co</span> <span class="o">&lt;=</span> <span class="n">co</span> <span class="o">+</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Mod10 down counter that count from 0-9
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">counter_down</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span> <span class="n">rst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">co</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rst</span><span class="p">)</span> <span class="c1">// use of if else
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">co</span> <span class="o">&lt;=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">co</span> <span class="o">==</span> <span class="mh">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">co</span> <span class="o">&lt;=</span> <span class="mh">4</span><span class="mi">&#39;d9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">co</span> <span class="o">&lt;=</span> <span class="n">co</span> <span class="o">-</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="在行为级模型中使用task">在行为级模型中使用task</h4>
<p>在这个例子中，已经开发了一个逻辑来使用任务作为行为级模型中的子程序来计算输入的二进制字符串中1的数量。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Main module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">task_count_1</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">integer</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">count_1</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">task</span> <span class="n">count_1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">output</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">input</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">=</span> <span class="mh">8</span><span class="mi">&#39;d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">8</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mh">1</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1">// x[i] is true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="n">cout</span> <span class="o">=</span> <span class="n">cout</span> <span class="o">+</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                    <span class="n">cout</span> <span class="o">=</span> <span class="n">cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">end</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">endtask</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Test bench
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">task_count_1test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">task_count_1</span> <span class="n">u</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="mh">8</span><span class="mi">&#39;d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">8</span><span class="mi">&#39;d7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">8</span><span class="mi">&#39;d9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">8</span><span class="mi">&#39;d8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">8</span><span class="mi">&#39;d15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">5</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="交通信号灯控制器">交通信号灯控制器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">traffic_signal_lights</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">clk</span><span class="p">,</span> <span class="n">cred</span><span class="p">,</span> <span class="n">cyellow</span><span class="p">,</span> <span class="n">cgreen</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">parameter</span> <span class="n">on</span> <span class="o">=</span> <span class="mh">1</span><span class="p">,</span> <span class="n">off</span> <span class="o">=</span> <span class="mh">0</span><span class="p">,</span> <span class="n">cred_tics</span> <span class="o">=</span> <span class="mh">30</span><span class="p">,</span> <span class="n">cyellow_tics</span> <span class="o">=</span> <span class="mh">3</span><span class="p">,</span> <span class="n">cgreen_tics</span> <span class="o">=</span> <span class="mh">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">cred</span> <span class="o">=</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cyellow</span> <span class="o">=</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cgreen</span> <span class="o">=</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">always</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="n">cred</span> <span class="o">=</span> <span class="n">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">light</span><span class="p">(</span><span class="n">cred</span><span class="p">,</span> <span class="n">cred_tics</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">cgreen</span> <span class="o">=</span> <span class="n">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">light</span><span class="p">(</span><span class="n">green</span><span class="p">,</span> <span class="n">cgreen_tics</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">cyellow</span> <span class="o">=</span> <span class="n">on</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">light</span><span class="p">(</span><span class="n">cyellow</span><span class="p">,</span> <span class="n">cyellow_tics</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Task to wait for positive edge clocks of tic
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">task</span> <span class="n">light</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">output</span> <span class="n">col</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">input</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">tic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">begin</span>
</span></span><span class="line"><span class="cl">            <span class="k">repeat</span> <span class="p">(</span><span class="n">tic</span><span class="p">)</span> <span class="p">@</span> <span class="p">(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">col</span> <span class="o">=</span> <span class="n">off</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">endtask</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">15</span> <span class="n">clk</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">#</span><span class="mh">1</span> <span class="n">clk</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h4 id="汉明码h-k-编码器解码器">汉明码（h, k) 编码器/解码器</h4>
<p>汉明码是检查和纠正输入比特流中错误比特的技术之一。它可分为生成器电路、校验器电路和校正器电路三个部分。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Encoder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">ham_en</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">co</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">6</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">co</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">co</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mh">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">co</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mh">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">co</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mh">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">co</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">i</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">i</span><span class="p">[</span><span class="mh">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">co</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mh">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">co</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">i</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">i</span><span class="p">[</span><span class="mh">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">co</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">i</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">i</span><span class="p">[</span><span class="mh">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Decoder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">ham_dec</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">co</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">cout</span><span class="p">,</span> <span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="p">[</span><span class="mh">6</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">co</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">6</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">cout</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">co</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">co</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">co</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">co</span><span class="p">[</span><span class="mh">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">=</span> <span class="n">co</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mh">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">c</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mh">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="n">cout</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cout</span><span class="p">[</span><span class="mh">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cout</span><span class="p">[</span><span class="mh">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cout</span><span class="p">[</span><span class="mh">5</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cout</span><span class="p">[</span><span class="mh">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h5 id="频率分频电路">频率分频电路</h5>
<p>频率分频器可以通过f/n来完成分频增加时钟脉冲持续时间，n为整数，下面用代码实现f/2的大于100MHz的分频。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">// Design Module
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">clockdivide</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">nclk</span><span class="p">);</span> <span class="c1">// clk and nclk are the clock input and output of divider circuit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">input</span> <span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">reg</span> <span class="n">nclk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">count</span> <span class="o">=</span> <span class="mh">32</span><span class="mi">&#39;d0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mh">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">nclk</span> <span class="o">=</span> <span class="n">count</span><span class="p">[</span><span class="mh">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Test Stimulus
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">module</span> <span class="n">clockdivide_test</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">reg</span> <span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="n">nclk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">clockdivide</span> <span class="n">uu</span><span class="p">(</span><span class="n">clk</span><span class="p">,</span> <span class="n">nclk</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="k">begin</span>
</span></span><span class="line"><span class="cl">        <span class="n">clk</span> <span class="o">=</span> <span class="mh">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">forever</span> <span class="p">#</span><span class="mh">5</span> <span class="n">clk</span> <span class="o">=</span> <span class="o">~</span><span class="n">clk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">initial</span> <span class="p">#</span><span class="mh">1000000000</span> <span class="nb">$stop</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><h2 id="system-verilog">System Verilog</h2>
<h3 id="介绍">介绍</h3>
<p>SV相比 Verilog 具有一些额外的特性，这使得它对于快速发展的技术变得更具吸引力，引入了面向对象这一编程思想？</p>
<h3 id="sv的独特特性">SV的独特特性</h3>
<p>SV拥有许多拓展特性，使得成为比verilog更好的硬件设计和验证语言：</p>
<ul>
<li>非阻塞赋值和阻塞赋值可以用于数组</li>
<li>输入、输出和inout端口支持更多数据类型，比如实数、结构体和枚举以及多维数组</li>
<li>再循环语句内部可以自动声明变量，while循环可以使用do-while</li>
<li>增量/减量运算符，例如 <code>i++</code>, <code>++i</code>, <code>i--</code>, <code>--i</code>。</li>
<li>复合赋值运算符，例如 <code>i += x</code>, <code>i -= x</code>, <code>i *= x</code>, <code>i /= x</code>, <code>i %= x</code>, <code>i &lt;&lt;= x</code>, <code>i &gt;&gt;= x</code>, <code>i &amp;= x</code>, <code>i ^= x</code>, <code>i |= x</code>。</li>
<li>fork-join 块中的新特性，包括 <code>join_none</code> 和 <code>join_any</code>。</li>
<li>在 SystemVerilog 中，函数可以不返回值，声明为 <code>void</code>。</li>
<li>参数可以声明为任何类型，包括用户定义的 typedef。</li>
<li>SystemVerilog 提供了一种与其他语言（如 C&amp;C++）进行接口的方法，称为 Direct Programming Interface（DPI）。</li>
</ul>
<h4 id="数据类型-1">数据类型</h4>
<p>SV在几乎所有类别中引入了新的数据类型，收到了C语言的启发，使得C到verilog更加舒适。</p>
<ul>
<li>verilog中有0、1、x、z四种可能变量，SV中只有0、1</li>
<li>在reg 或者 wire 的位置换成logic，SV允许自由决定哪个声明为reg或者wire</li>
<li>Sv只需声明logic，综合工具转换为reg或者wire
下面展示了一个4位加法器的SV代码，可以和verilog代码比较</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">adder4bit</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="kt">logic</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="kt">logic</span> <span class="n">c</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">logic</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">sum</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">logic</span> <span class="n">carry</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">logic</span> <span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">carry</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mh">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span><span class="o">:</span><span class="n">adder4bit</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="k">module</span> <span class="n">adder4bit</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="kt">reg</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">input</span> <span class="kt">reg</span> <span class="n">c</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">wire</span> <span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">sum</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">output</span> <span class="kt">wire</span> <span class="n">carry</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">wire</span> <span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">assign</span> <span class="n">carry</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mh">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">endmodule</span>
</span></span></code></pre></div><p>模块和 endmodule 的语法有一个区别，即在 endmodule 后面也写上模块名称，用冒号“:”分隔。<br>
另一个区别是声明“logic”而不是“wire”以及“reg.” 如果我们在 SystemVerilog 中将信号声明为“logic”，综合工具将会确定它是“wire”还是“reg.”</p>
<h4 id="数组">数组</h4>
<p>在verilog中，虽然允许使用多维数组的net和变量，但是有所限制。SV的多维数组允许更多的操作。</p>
<p>比如：<code>reg [3:0][4:0] register [0:6];</code></p>
<p>p213</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-04-03</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://maequeen.top/posts/2-4-digitaliclearning/" data-title="2-4 Digital IC Learning" data-via="这不是我"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://maequeen.top/posts/2-4-digitaliclearning/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://maequeen.top/posts/2-4-digitaliclearning/" data-title="2-4 Digital IC Learning"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://maequeen.top/posts/2-4-digitaliclearning/" data-title="2-4 Digital IC Learning"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://maequeen.top/posts/2-4-digitaliclearning/" data-title="2-4 Digital IC Learning"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2-2-say-thank-you-to-ehco-the-free-gpt4/" class="prev" rel="prev" title="2-2 快说感谢赛博活菩萨ehco，用上免费的gpt4了"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>2-2 快说感谢赛博活菩萨ehco，用上免费的gpt4了</a>
            <a href="/posts/2-5-qingming-in-wudangs-not-a-good-idea/" class="next" rel="next" title="2-5 为笨蛋朋友的决策买单：清明游武当山">2-5 为笨蛋朋友的决策买单：清明游武当山<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">龙山</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=419596181&auto=1&height=66"></iframe>

<a href="https://info.flagcounter.com/qhiN"><img src="https://s01.flagcounter.com/mini/qhiN/bg_FCF7FF/txt_000000/border_278FCC/flags_0/" alt="Flag Counter" border="0"></a>



</div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"data":{"id-1":"一夔的小窝","id-2":"一夔的小窝"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"twemoji":true,"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
